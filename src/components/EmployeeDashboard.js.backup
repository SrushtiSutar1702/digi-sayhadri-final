import React, { useState, useEffect } from 'react';
import { ref, onValue, update } from 'firebase/database';
import { database } from '../firebase';
import { useNavigate } from 'react-router-dom';
import { auth } from '../firebase';
import { CheckCircle, XCircle, Clock, LogOut, User, Calendar, AlertCircle, PlayCircle, Send, Filter, Video, Image, LayoutDashboard, Search, List, Grid, Download, BarChart3, PieChart, TrendingUp } from 'lucide-react';
import { useToast, ToastContainer } from './Toast';
import { jsPDF } from 'jspdf';
import autoTable from 'jspdf-autotable';
import * as XLSX from 'xlsx';
import confetti from 'canvas-confetti';
import RevisionNotificationPopup from './RevisionNotificationPopup';
import './Dashboard.css';
import './EmployeeDashboard.css';

const EmployeeDashboard = ({ employeeData = null, isEmbedded = false }) => {
  const [tasks, setTasks] = useState([]);
  const [employeeName, setEmployeeName] = useState('');
  const [selectedStatus, setSelectedStatus] = useState('all');
  const [selectedDepartment, setSelectedDepartment] = useState('all');
  const [selectedMonth, setSelectedMonth] = useState(new Date().toISOString().slice(0, 7));
  const [activeFilter, setActiveFilter] = useState('all'); // For statistics card filtering
  const [selectedTasks, setSelectedTasks] = useState({}); // For task selection by client
  const [showNameSelector, setShowNameSelector] = useState(false);
  const [customNameInput, setCustomNameInput] = useState('');
  const [employees, setEmployees] = useState([]);
  const [loginEmail, setLoginEmail] = useState('');
  const [loginPassword, setLoginPassword] = useState('');
  const [loginError, setLoginError] = useState('');
  const [employeeDepartment, setEmployeeDepartment] = useState('');
  const [clients, setClients] = useState([]);
  const [expandedClients, setExpandedClients] = useState({});
  const [searchQuery, setSearchQuery] = useState(''); // For search functionality
  const [viewMode, setViewMode] = useState('list'); // 'list' or 'card' view mode
  const [selectedClientForCardView, setSelectedClientForCardView] = useState(null); // For card view client selection
  const [showSocialMediaEmployeeModal, setShowSocialMediaEmployeeModal] = useState(false);
  const [selectedTaskForSending, setSelectedTaskForSending] = useState(null);
  const [showRevisionNoteModal, setShowRevisionNoteModal] = useState(false);
  const [selectedRevisionNote, setSelectedRevisionNote] = useState('');
  const [showReports, setShowReports] = useState(false); // For Reports section
  const [showDownloadOptions, setShowDownloadOptions] = useState(false); // For download dropdown
  const [showReportCheckboxes, setShowReportCheckboxes] = useState(false); // For report selection checkboxes
  const [selectedReportClients, setSelectedReportClients] = useState(new Set()); // Selected clients for download
  const [selectedReportTaskIds, setSelectedReportTaskIds] = useState(new Set()); // Selected task IDs for download
  const [showReportFormatDropdown, setShowReportFormatDropdown] = useState(false); // Format dropdown for reports
  const navigate = useNavigate();
  const { toasts, showToast, removeToast } = useToast();

  // Function to group tasks by client
  const groupTasksByClient = (tasks) => {
    const grouped = {};
    tasks.forEach(task => {
      const clientName = task.clientName || 'Unknown Client';
      if (!grouped[clientName]) {
        grouped[clientName] = [];
      }
      grouped[clientName].push(task);
    });
    return grouped;
  };

  // Function to toggle client expansion
  const toggleClientExpansion = (clientName) => {
    setExpandedClients(prev => ({
      ...prev,
      [clientName]: !prev[clientName]
    }));
  };

  // Detect employee's department based on their name from database
  const getEmployeeDepartment = (name) => {
    const employee = employees.find(emp => emp.employeeName === name);
    if (employee) {
      return employee.department;
    }
    // Fallback to old detection method for backward compatibility
    if (name.includes('Video Editor') || name.includes('Videographer')) {
      return 'video';
    } else if (name.includes('Graphic Designer') || name.includes('Illustrator')) {
      return 'graphics';
    } else if (name.includes('Social Media')) {
      return 'social-media';
    }
    return null;
  };

  // Detect department from email
  const getDepartmentFromEmail = (email) => {
    if (!email) return null;
    const emailLower = email.toLowerCase();
    if (emailLower.includes('video')) return 'video';
    if (emailLower.includes('graphic')) return 'graphics';
    if (emailLower.includes('social')) return 'social-media';
    return null;
  };

  // Get current employee's department (from name or email)
  const getCurrentDepartment = () => {
    // First try to get from sessionStorage (set during login)
    const storedDepartment = sessionStorage.getItem('employeeDepartment');
    if (storedDepartment) {
      return storedDepartment;
    }

    // Try to get from stored employee data
    const storedEmployeeData = sessionStorage.getItem('employeeData');
    if (storedEmployeeData) {
      try {
        const employeeData = JSON.parse(storedEmployeeData);
        if (employeeData.department) {
          return employeeData.department.toLowerCase();
        }
      } catch (e) {
        console.error('Error parsing employee data:', e);
      }
    }

    // Try to get from employee name
    if (employeeName) {
      return getEmployeeDepartment(employeeName);
    }

    // If no name yet, try to get from email
    const user = auth.currentUser;
    if (user && user.email) {
      return getDepartmentFromEmail(user.email);
    }
    return null;
  };

  const currentDepartment = getCurrentDepartment();

  // Fetch employees from database
  useEffect(() => {
    const employeesRef = ref(database, 'employees');
    const unsubscribe = onValue(employeesRef, (snapshot) => {
      const data = snapshot.val();
      if (data) {
        const employeesList = Object.keys(data).map(key => ({
          id: key,
          ...data[key]
        }));
        setEmployees(employeesList);
        
        // Check if current logged-in employee is inactive
        if (!isEmbedded) {
          const storedEmail = sessionStorage.getItem('employeeData');
          if (storedEmail) {
            try {
              const empData = JSON.parse(storedEmail);
              const currentEmp = employeesList.find(e => e.email === empData.email);
              if (currentEmp && currentEmp.status === 'inactive') {
                // Employee has been disabled, log them out
                sessionStorage.clear();
                localStorage.clear();
                showToast('Your account has been disabled. Please contact the administrator.', 'error');
                setTimeout(() => {
                  navigate('/');
                }, 2000);
              }
            } catch (e) {
              console.error('Error checking employee status:', e);
            }
          }
        }
      } else {
        setEmployees([]);
      }
    });
    return () => unsubscribe();
  }, [isEmbedded, navigate, showToast]);

  // Initialize employee data from props (when embedded) or sessionStorage (set during login)
  useEffect(() => {
    // If embedded in SuperAdmin with employee data, use that directly
    if (isEmbedded && employeeData) {
      setEmployeeName(employeeData.employeeName);
      setEmployeeDepartment(employeeData.department);
      console.log('Loaded employee info from props:', employeeData);
      return;
    }

    // Otherwise, load from sessionStorage
    const storedDepartment = sessionStorage.getItem('employeeDepartment');
    const storedName = sessionStorage.getItem('employeeName');
    const storedEmployeeData = sessionStorage.getItem('employeeData');

    // If we have sessionStorage data (from employee login), use it and clear localStorage
    if (storedDepartment || storedName || storedEmployeeData) {
      // Clear old localStorage data to prevent conflicts
      localStorage.removeItem('employeeName');
      localStorage.removeItem('employeeDepartment');
      localStorage.removeItem('employeeEmail');

      if (storedDepartment) {
        setEmployeeDepartment(storedDepartment);
      }

      if (storedName) {
        setEmployeeName(storedName);
      }

      if (storedEmployeeData) {
        try {
          const employeeData = JSON.parse(storedEmployeeData);
          if (employeeData.employeeName && !storedName) {
            setEmployeeName(employeeData.employeeName);
          }
          if (employeeData.department && !storedDepartment) {
            setEmployeeDepartment(employeeData.department);
          }
        } catch (e) {
          console.error('Error parsing employee data:', e);
        }
      }
    }
  }, [employeeData, isEmbedded]);

  // Fetch clients (only active ones)
  useEffect(() => {
    const clientsRef = ref(database, 'clients');
    const unsubscribe = onValue(clientsRef, (snapshot) => {
      const data = snapshot.val();
      if (data) {
        const clientsList = Object.keys(data).map(key => ({
          id: key,
          ...data[key]
        })).filter(client => (client.status || 'active') === 'active'); // Only show active clients
        setClients(clientsList);
      } else {
        setClients([]);
      }
    });
    return () => unsubscribe();
  }, []);

  // Get employee names for name selector based on current department
  const getEmployeeNamesForSelector = () => {
    if (currentDepartment) {
      return employees
        .filter(emp => emp.department === currentDepartment)
        .map(emp => emp.employeeName);
    }
    // If no department detected, show all employee names
    return employees.map(emp => emp.employeeName);
  };

  const employeeNames = getEmployeeNamesForSelector();

  useEffect(() => {
    // Get employee name from sessionStorage (priority) or localStorage or auth
    const user = auth.currentUser;
    const sessionName = sessionStorage.getItem('employeeName');
    const savedName = localStorage.getItem('employeeName');

    // Prioritize sessionStorage (set during employee login)
    if (sessionName) {
      setEmployeeName(sessionName);
      return;
    }

    if (savedName && user && user.email) {
      // Check if saved name's department matches email's department
      const savedNameDept = getEmployeeDepartment(savedName);
      const emailDept = getDepartmentFromEmail(user.email);

      if (emailDept && savedNameDept !== emailDept) {
        // Department mismatch! Clear saved name and show selector
        localStorage.removeItem('employeeName');
        setShowNameSelector(true);
      } else {
        setEmployeeName(savedName);
      }
    } else if (savedName) {
      setEmployeeName(savedName);
    } else if (user && user.email) {
      // Detect department from email
      const deptFromEmail = getDepartmentFromEmail(user.email);

      // If we can detect department from email, show name selector
      // Otherwise use email username
      if (deptFromEmail) {
        setShowNameSelector(true);
      } else {
        const name = user.displayName || user.email?.split('@')[0] || '';
        if (name) {
          setEmployeeName(name);
        } else {
          setShowNameSelector(true);
        }
      }
    } else {
      setShowNameSelector(true);
    }
  }, []);

  const handleLogin = (e) => {
    e.preventDefault();
    setLoginError('');

    // Find employee with matching email and password
    const employee = employees.find(emp =>
      emp.email === loginEmail && emp.password === loginPassword
    );

    if (employee) {
      setEmployeeName(employee.employeeName);
      setEmployeeDepartment(employee.department);
      localStorage.setItem('employeeName', employee.employeeName);
      localStorage.setItem('employeeEmail', employee.email);
      localStorage.setItem('employeeDepartment', employee.department);
      setShowNameSelector(false);
      showToast(`Welcome, ${employee.employeeName}!`, 'success');
    } else {
      setLoginError('Invalid email or password');
      showToast('Invalid email or password', 'error');
    }
  };

  const handleNameSelect = (name) => {
    const oldName = employeeName;
    setEmployeeName(name);
    localStorage.setItem('employeeName', name);
    setShowNameSelector(false);
    setCustomNameInput(''); // Reset custom input
    if (oldName && oldName !== name) {
      showToast(`Name changed from ${oldName} to ${name}!`, 'success');
    } else {
      showToast(`Welcome, ${name}!`, 'success');
    }
  };

  useEffect(() => {
    if (!employeeName) return;

    const employeeDepartment = getEmployeeDepartment(employeeName);

    // Fetch tasks assigned to this employee ONLY from their department
    const tasksRef = ref(database, 'tasks');
    const unsubscribe = onValue(tasksRef, (snapshot) => {
      const data = snapshot.val();
      if (data) {
        const tasksList = Object.keys(data).map(key => ({
          id: key,
          ...data[key]
        })).filter(task => {
          // Show tasks assigned to this employee
          // Keep showing tasks even after they're sent for approval or department changes
          const isAssignedToMe = task.assignedTo &&
            task.assignedTo.toLowerCase().trim() === employeeName.toLowerCase().trim();

          // Also check if task was submitted by this employee (to keep visibility after sending)
          const wasSubmittedByMe = task.submittedBy === employeeName;

          // Also check if task was originally from employee's department
          const isMyDepartment = employeeDepartment ?
            (task.department === employeeDepartment ||
              task.originalDepartment === employeeDepartment) : true;

          return (isAssignedToMe || wasSubmittedByMe) && isMyDepartment;
        });

        // Sort by deadline (upcoming first)
        tasksList.sort((a, b) => {
          if (!a.deadline) return 1;
          if (!b.deadline) return -1;
          return new Date(a.deadline) - new Date(b.deadline);
        });

        setTasks(tasksList);
      } else {
        setTasks([]);
      }
    }, (error) => {
      console.error('Error fetching tasks:', error);
      setTasks([]);
    });

    return () => unsubscribe();
  }, [employeeName]);

  const handleStartWork = (taskId) => {
    const taskRef = ref(database, `tasks/${taskId}`);
    const currentTask = tasks.find(t => t.id === taskId);

    const updateData = {
      status: 'in-progress',
      startedAt: new Date().toISOString(),
      lastUpdated: new Date().toISOString()
    };

    // Preserve revision count and related data
    if (currentTask?.revisionCount) {
      updateData.revisionCount = currentTask.revisionCount;
    }
    if (currentTask?.lastRevisionAt) {
      updateData.lastRevisionAt = currentTask.lastRevisionAt;
    }

    update(taskRef, updateData);
    showToast('Task started! You can now work on it.', 'success');
  };

  const handleStartTask = (taskId) => {
    const taskRef = ref(database, `tasks/${taskId}`);
    const currentTask = tasks.find(t => t.id === taskId);

    const updateData = {
      status: 'in-progress',
      startedAt: new Date().toISOString(),
      lastUpdated: new Date().toISOString()
    };

    update(taskRef, updateData);
    showToast('ðŸš€ Task started! The start time has been recorded.', 'success');
  };

  const handleMarkComplete = (taskId) => {
    const taskRef = ref(database, `tasks/${taskId}`);
    const currentTask = tasks.find(t => t.id === taskId);

    const updateData = {
      status: 'completed',
      completedAt: new Date().toISOString(),
      lastUpdated: new Date().toISOString()
    };

    // Preserve revision count and related data
    if (currentTask?.revisionCount) {
      updateData.revisionCount = currentTask.revisionCount;
    }
    if (currentTask?.lastRevisionAt) {
      updateData.lastRevisionAt = currentTask.lastRevisionAt;
    }

    update(taskRef, updateData);
    showToast('ðŸŽ‰ Task marked as completed! Click "Send for Approval" to submit for client review.', 'success');

    // Create congratulations message overlay
    const congratsDiv = document.createElement('div');
    congratsDiv.innerHTML = `
      <div style="
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 40px 60px;
        border-radius: 20px;
        font-size: 32px;
        font-weight: bold;
        text-align: center;
        z-index: 10000;
        box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        animation: bounceIn 0.6s ease-out;
      ">
        <div style="font-size: 48px; margin-bottom: 10px;">ðŸŽ‰</div>
        <div>Congratulations!</div>
        <div style="font-size: 24px; margin-top: 10px; font-weight: 500;">You completed your task!</div>
        <div style="font-size: 18px; margin-top: 15px; opacity: 0.9;">Great work! Keep it up! ðŸ’ª</div>
      </div>
    `;

    // Add animation keyframes
    const style = document.createElement('style');
    style.textContent = `
      @keyframes bounceIn {
        0% { transform: translate(-50%, -50%) scale(0.3); opacity: 0; }
        50% { transform: translate(-50%, -50%) scale(1.05); }
        70% { transform: translate(-50%, -50%) scale(0.9); }
        100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
      }
      @keyframes fadeOut {
        0% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
      }
    `;
    document.head.appendChild(style);
    document.body.appendChild(congratsDiv);

    // Remove message after 4 seconds with fade out
    setTimeout(() => {
      congratsDiv.firstElementChild.style.animation = 'fadeOut 0.5s ease-out';
      setTimeout(() => {
        document.body.removeChild(congratsDiv);
        document.head.removeChild(style);
      }, 500);
    }, 4000);

    // Function to play rocket launch sound using Web Audio API
    const playRocketSound = () => {
      try {
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();

        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);

        oscillator.frequency.setValueAtTime(200, audioContext.currentTime);
        oscillator.frequency.exponentialRampToValueAtTime(800, audioContext.currentTime + 0.5);

        gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);

        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.5);
      } catch (e) {
        console.log('Audio not supported');
      }
    };

    // Function to play explosion sound using Web Audio API
    const playExplosionSound = () => {
      try {
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        const bufferSize = audioContext.sampleRate * 0.5;
        const buffer = audioContext.createBuffer(1, bufferSize, audioContext.sampleRate);
        const data = buffer.getChannelData(0);

        for (let i = 0; i < bufferSize; i++) {
          data[i] = (Math.random() * 2 - 1) * Math.exp(-i / (bufferSize / 3));
        }

        const source = audioContext.createBufferSource();
        const gainNode = audioContext.createGain();

        source.buffer = buffer;
        source.connect(gainNode);
        gainNode.connect(audioContext.destination);

        gainNode.gain.setValueAtTime(0.5, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);

        source.start();
      } catch (e) {
        console.log('Audio not supported');
      }
    };

    // Create rocket fireworks animation
    const launchRocket = () => {
      // Play rocket launch sound
      playRocketSound();

      // Rocket shooting up effect with trail
      const end = Date.now() + 800;
      const colors = ['#ff0000', '#ff7700', '#ffdd00'];

      (function frame() {
        confetti({
          particleCount: 2,
          angle: 90,
          spread: 10,
          origin: { x: 0.5, y: 1 },
          colors: colors,
          ticks: 50,
          gravity: -3,
          decay: 0.95,
          startVelocity: 50,
          scalar: 1.5,
          zIndex: 9999
        });

        if (Date.now() < end) {
          requestAnimationFrame(frame);
        }
      }());

      // Explosion at the top after delay
      setTimeout(() => {
        // Play explosion sound
        playExplosionSound();

        // Big explosion burst
        confetti({
          particleCount: 200,
          spread: 360,
          startVelocity: 60,
          origin: { x: 0.5, y: 0.2 },
          colors: ['#ff0000', '#ff7700', '#ffdd00', '#00ff00', '#0099ff', '#9933ff', '#ff1493'],
          ticks: 300,
          gravity: 1,
          scalar: 2,
          zIndex: 9999,
          shapes: ['circle', 'square']
        });

        // Multiple smaller bursts for crackling effect
        for (let i = 0; i < 5; i++) {
          setTimeout(() => {
            confetti({
              particleCount: 50,
              spread: 360,
              startVelocity: 35,
              origin: {
                x: Math.random() * 0.6 + 0.2,
                y: Math.random() * 0.3 + 0.1
              },
              colors: ['#ff0000', '#ff7700', '#ffdd00', '#00ff00', '#0099ff', '#9933ff'],
              ticks: 200,
              gravity: 1.2,
              scalar: 1.5,
              zIndex: 9999
            });
          }, i * 200);
        }
      }, 800);
    };

    // Launch multiple rockets
    launchRocket();
    setTimeout(launchRocket, 1000);
    setTimeout(launchRocket, 2000);
  };

  const handleSendForApproval = (taskId, task) => {
    // Show modal to select social media employee
    setSelectedTaskForSending(task);
    setShowSocialMediaEmployeeModal(true);
  };

  const handleSendToSocialMediaEmployee = (selectedEmployee) => {
    if (!selectedEmployee || !selectedTaskForSending) return;

    const taskRef = ref(database, `tasks/${selectedTaskForSending.id}`);
    const currentTask = tasks.find(t => t.id === selectedTaskForSending.id);

    const updateData = {
      status: 'pending-client-approval',
      submittedAt: new Date().toISOString(),
      submittedBy: employeeName,
      department: 'social-media',
      socialMediaAssignedTo: selectedEmployee,
      originalDepartment: currentDepartment || currentTask?.originalDepartment,
      lastUpdated: new Date().toISOString(),
      revisionMessage: null // Clear revision message when re-submitting
    };

    // Preserve revision count and related data
    if (currentTask?.revisionCount) {
      updateData.revisionCount = currentTask.revisionCount;
    }
    if (currentTask?.lastRevisionAt) {
      updateData.lastRevisionAt = currentTask.lastRevisionAt;
    }

    update(taskRef, updateData);
    showToast(`âœ… Task sent to ${selectedEmployee} for client approval!`, 'success', 5000);
    setShowSocialMediaEmployeeModal(false);
    setSelectedTaskForSending(null);
  };

  const handleStartRevision = (taskId) => {
    const taskRef = ref(database, `tasks/${taskId}`);
    const currentTask = tasks.find(t => t.id === taskId);

    const updateData = {
      status: 'in-progress',
      revisionStartedAt: new Date().toISOString(),
      lastUpdated: new Date().toISOString()
    };

    // Preserve revision count and related data
    if (currentTask?.revisionCount) {
      updateData.revisionCount = currentTask.revisionCount;
    }
    if (currentTask?.lastRevisionAt) {
      updateData.lastRevisionAt = currentTask.lastRevisionAt;
    }

    update(taskRef, updateData);
    showToast('Started working on revisions.', 'info');
  };

  // Handle status change from dropdown
  const handleStatusChange = (taskId, newStatus) => {
    const taskRef = ref(database, `tasks/${taskId}`);
    const currentTask = tasks.find(t => t.id === taskId);

    const updateData = {
      status: newStatus,
      lastUpdated: new Date().toISOString()
    };

    // Preserve revision count and related data
    if (currentTask?.revisionCount) {
      updateData.revisionCount = currentTask.revisionCount;
    }
    if (currentTask?.lastRevisionAt) {
      updateData.lastRevisionAt = currentTask.lastRevisionAt;
    }

    // Add specific timestamps based on status
    if (newStatus === 'in-progress' && currentTask?.status !== 'in-progress') {
      updateData.startedAt = new Date().toISOString();
    } else if (newStatus === 'completed') {
      updateData.completedAt = new Date().toISOString();
    } else if (newStatus === 'pending-client-approval') {
      updateData.submittedAt = new Date().toISOString();
      updateData.submittedBy = employeeName;
    }

    update(taskRef, updateData);
    showToast(`Status updated to ${newStatus.replace(/-/g, ' ')}`, 'success');
  };

  const handleLogout = () => {
    auth.signOut().then(() => {
      navigate('/');
    });
  };

  const getStatusIcon = (status) => {
    switch (status) {
      case 'completed':
      case 'approved':
      case 'posted':
        return <CheckCircle size={18} color="green" />;
      case 'revision-required':
        return <XCircle size={18} color="red" />;
      case 'in-progress':
        return <Clock size={18} color="orange" />;
      default:
        return <Clock size={18} color="gray" />;
    }
  };

  const getStatusColor = (status) => {
    switch (status) {
      case 'completed':
      case 'approved':
      case 'posted':
        return '#28a745';
      case 'in-progress':
        return '#ffc107';
      case 'pending-client-approval':
        return '#17a2b8';
      case 'revision-required':
        return '#dc3545';
      case 'assigned':
        return '#6c757d';
      default:
        return '#95a5a6';
    }
  };

  const getDepartmentColor = (dept) => {
    switch (dept) {
      case 'strategy': return '#9b59b6';
      case 'video': return '#e74c3c';
      case 'graphics': return '#3498db';
      case 'social-media': return '#1abc9c';
      default: return '#95a5a6';
    }
  };

  // Function to toggle task selection
  const toggleTaskSelection = (clientName, taskId) => {
    setSelectedTasks(prev => {
      const clientTasks = prev[clientName] || [];
      const isSelected = clientTasks.includes(taskId);

      if (isSelected) {
        return {
          ...prev,
          [clientName]: clientTasks.filter(id => id !== taskId)
        };
      } else {
        return {
          ...prev,
          [clientName]: [...clientTasks, taskId]
        };
      }
    });
  };

  // Function to check if task is selected
  const isTaskSelected = (clientName, taskId) => {
    return (selectedTasks[clientName] || []).includes(taskId);
  };

  // Function to get selected tasks count for a client
  const getSelectedTasksCount = (clientName) => {
    return (selectedTasks[clientName] || []).length;
  };

  // Function to download PDF report for selected tasks
  const downloadClientReport = (clientName, clientTasks) => {
    const selectedTaskIds = selectedTasks[clientName] || [];
    if (selectedTaskIds.length === 0) {
      showToast('Please select at least one task to download', 'warning');
      return;
    }

    const tasksToDownload = clientTasks.filter(task => selectedTaskIds.includes(task.id));

    // Create HTML content for PDF
    const htmlContent = `
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8">
        <title>${employeeName} - ${clientName} Tasks Report</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; }
          .header { text-align: center; margin-bottom: 30px; border-bottom: 3px solid #667eea; padding-bottom: 20px; }
          .header h1 { color: #667eea; margin: 0; }
          .info { margin: 20px 0; }
          .info-row { display: flex; justify-content: space-between; margin: 10px 0; }
          table { width: 100%; border-collapse: collapse; margin-top: 20px; }
          th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
          th { background-color: #667eea; color: white; font-weight: bold; }
          tr:nth-child(even) { background-color: #f9f9f9; }
          .status { padding: 4px 8px; border-radius: 12px; font-size: 11px; font-weight: bold; display: inline-block; }
          .footer { margin-top: 30px; text-align: center; color: #666; font-size: 12px; }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>Task Report - ${clientName}</h1>
          <p>Employee: ${employeeName}</p>
          <p>Generated on ${new Date().toLocaleDateString('en-US', {
      weekday: 'long',
      year: 'numeric',
      month: 'long',
      day: 'numeric'
    })}</p>
        </div>
        
        <div class="info">
          <div class="info-row">
            <strong>Total Selected Tasks:</strong>
            <span>${tasksToDownload.length}</span>
          </div>
          <div class="info-row">
            <strong>Month:</strong>
            <span>${new Date(selectedMonth + '-01').toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}</span>
          </div>
        </div>

        <table>
          <thead>
            <tr>
              <th>Task Name</th>
              <th>Project</th>
              <th>Department</th>
              <th>Deadline</th>
              <th>Status</th>
              <th>Revisions</th>
            </tr>
          </thead>
          <tbody>
            ${tasksToDownload.map(task => `
              <tr>
                <td><strong>${task.taskName || 'N/A'}</strong></td>
                <td>${task.projectName || 'N/A'}</td>
                <td style="text-transform: uppercase">${task.department || 'N/A'}</td>
                <td>${task.deadline ? new Date(task.deadline).toLocaleDateString() : 'N/A'}</td>
                <td><span class="status">${task.status?.replace(/-/g, ' ') || 'N/A'}</span></td>
                <td>${task.revisionCount || 0}</td>
              </tr>
            `).join('')}
          </tbody>
        </table>

        <div class="footer">
          <p>This report was generated from the Employee Dashboard</p>
          <p>Employee: ${employeeName} | Client: ${clientName}</p>
        </div>
      </body>
      </html>
    `;

    // Create a new window and print as PDF
    const printWindow = window.open('', '_blank');
    printWindow.document.write(htmlContent);
    printWindow.document.close();

    // Wait for content to load then trigger print
    setTimeout(() => {
      printWindow.focus();
      printWindow.print();

      // Close the window after printing
      setTimeout(() => {
        printWindow.close();
      }, 1000);
    }, 500);

    showToast(`PDF report generated with ${tasksToDownload.length} task(s)`, 'success');

    // Clear selections after download
    setSelectedTasks(prev => ({
      ...prev,
      [clientName]: []
    }));
  };

  // Handle statistics card clicks
  const handleStatCardClick = (filterType) => {
    setActiveFilter(filterType);
    setSelectedStatus('all'); // Reset dropdown filter

    // Show toast message
    const filterMessages = {
      'all': `Showing all ${tasks.filter(t => {
        const taskDate = t.deadline;
        return taskDate && taskDate.startsWith(selectedMonth);
      }).length} tasks`,
      'in-progress': `Showing ${tasks.filter(t => t.status === 'in-progress' && t.deadline && t.deadline.startsWith(selectedMonth)).length} in-progress tasks`,
      'completed': `Showing ${tasks.filter(t => t.status === 'completed' && t.deadline && t.deadline.startsWith(selectedMonth)).length} completed tasks`,
      'pending-client-approval': `Showing ${tasks.filter(t => t.status === 'pending-client-approval' && t.deadline && t.deadline.startsWith(selectedMonth)).length} pending approval tasks`,
      'approved': `Showing ${tasks.filter(t => t.status === 'approved' && t.deadline && t.deadline.startsWith(selectedMonth)).length} approved tasks`,
      'posted': `Showing ${tasks.filter(t => t.status === 'posted' && t.deadline && t.deadline.startsWith(selectedMonth)).length} posted tasks`,
      'revision-required': `Showing ${tasks.filter(t => t.status === 'revision-required' && t.deadline && t.deadline.startsWith(selectedMonth)).length} revision required tasks`
    };

    showToast(filterMessages[filterType] || 'Filter applied', 'info');

    // Auto-scroll to tasks section - scroll to the actual task cards
    setTimeout(() => {
      // Try multiple selectors to find the tasks section
      const tasksSection = document.querySelector('.card.full-width') ||
        document.querySelector('[style*="background: white"]') ||
        document.getElementById('tasks-section');

      if (tasksSection) {
        // Scroll with some offset to show the section nicely
        const yOffset = -20; // 20px offset from top
        const y = tasksSection.getBoundingClientRect().top + window.pageYOffset + yOffset;

        window.scrollTo({
          top: y,
          behavior: 'smooth'
        });
      }
    }, 100);
  };

  // Function to get search filtered tasks
  const getSearchFilteredTasks = () => {
    if (!searchQuery.trim()) {
      return filteredTasks;
    }

    const query = searchQuery.toLowerCase();
    return filteredTasks.filter(task =>
      task.taskName?.toLowerCase().includes(query) ||
      task.clientName?.toLowerCase().includes(query) ||
      task.projectName?.toLowerCase().includes(query) ||
      task.assignedTo?.toLowerCase().includes(query) ||
      task.status?.toLowerCase().includes(query)
    );
  };

  // Function to download all clients report
  const downloadAllClientsReport = () => {
    const groupedTasks = groupTasksByClient(getSearchFilteredTasks());
    const reportDate = new Date().toLocaleDateString();
    const period = new Date(selectedMonth + '-01').toLocaleDateString('en-US', { month: 'long', year: 'numeric' });

    // Create HTML content for PDF
    const htmlContent = `
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8">
        <title>${employeeName} - All Clients Report</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; }
          .header { text-align: center; margin-bottom: 30px; border-bottom: 3px solid #667eea; padding-bottom: 20px; }
          .header h1 { color: #667eea; margin: 0; }
          .summary { background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
          .client-section { margin-bottom: 30px; page-break-inside: avoid; }
          .client-header { background: #667eea; color: white; padding: 10px 15px; border-radius: 6px; margin-bottom: 10px; }
          table { width: 100%; border-collapse: collapse; margin-top: 10px; }
          th, td { border: 1px solid #ddd; padding: 10px; text-align: left; font-size: 12px; }
          th { background-color: #f1f3f5; color: #333; font-weight: bold; }
          tr:nth-child(even) { background-color: #f9f9f9; }
          .status { padding: 4px 8px; border-radius: 12px; font-size: 11px; font-weight: bold; display: inline-block; }
          .footer { margin-top: 30px; text-align: center; color: #666; font-size: 12px; border-top: 2px solid #ddd; padding-top: 15px; }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>${employeeName} - All Clients Report</h1>
          <p>Generated on ${reportDate}</p>
          <p>Period: ${period}</p>
        </div>
        
        <div class="summary">
          <h3>Report Summary</h3>
          <p><strong>Total Tasks:</strong> ${getSearchFilteredTasks().length}</p>
          <p><strong>Total Clients:</strong> ${Object.keys(groupedTasks).length}</p>
          <p><strong>Employee:</strong> ${employeeName}</p>
        </div>

        ${Object.entries(groupedTasks).map(([clientName, clientTasks]) => {
      const completed = clientTasks.filter(t => t.status === 'completed' || t.status === 'posted' || t.status === 'approved').length;
      const inProgress = clientTasks.filter(t => t.status === 'in-progress').length;

      return `
          <div class="client-section">
            <div class="client-header">
              <h2 style="margin: 0; font-size: 16px;">${clientName} (${clientTasks.length} tasks)</h2>
              <p style="margin: 5px 0 0 0; font-size: 13px; opacity: 0.9;">Completed: ${completed} | In Progress: ${inProgress}</p>
            </div>
            <table>
              <thead>
                <tr>
                  <th>Task Name</th>
                  <th>Project</th>
                  <th>Department</th>
                  <th>Deadline</th>
                  <th>Status</th>
                  <th>Revisions</th>
                </tr>
              </thead>
              <tbody>
                ${clientTasks.map(task => `
                  <tr>
                    <td><strong>${task.taskName || 'N/A'}</strong></td>
                    <td>${task.projectName || 'N/A'}</td>
                    <td style="text-transform: uppercase">${task.department || 'N/A'}</td>
                    <td>${task.deadline ? new Date(task.deadline).toLocaleDateString() : 'N/A'}</td>
                    <td><span class="status">${task.status?.replace(/-/g, ' ') || 'N/A'}</span></td>
                    <td>${task.revisionCount || 0}</td>
                  </tr>
                `).join('')}
              </tbody>
            </table>
          </div>
        `;
    }).join('')}

        <div class="footer">
          <p>This report was generated from the Employee Dashboard</p>
          <p>Employee: ${employeeName}</p>
        </div>
      </body>
      </html>
    `;

    // Create a new window and print as PDF
    const printWindow = window.open('', '_blank');
    printWindow.document.write(htmlContent);
    printWindow.document.close();

    // Wait for content to load then trigger print
    setTimeout(() => {
      printWindow.focus();
      printWindow.print();

      // Close the window after printing
      setTimeout(() => {
        printWindow.close();
      }, 1000);
    }, 500);

    showToast(`PDF report generated with ${getSearchFilteredTasks().length} task(s) from ${Object.keys(groupedTasks).length} client(s)`, 'success');
  };

  const filteredTasks = tasks.filter(task => {
    const statusMatch = selectedStatus === 'all' || task.status === selectedStatus;
    const deptMatch = selectedDepartment === 'all' || task.department === selectedDepartment;
    const taskDate = task.deadline;
    const monthMatch = taskDate && taskDate.startsWith(selectedMonth);

    // Apply active filter from statistics cards
    let cardFilterMatch = false;
    if (activeFilter === 'all') {
      cardFilterMatch = true;
    } else {
      cardFilterMatch = task.status === activeFilter;
    }

    return statusMatch && deptMatch && monthMatch && cardFilterMatch;
  });

  const stats = {
    total: tasks.length,
    assigned: tasks.filter(t => t.status === 'assigned').length,
    inProgress: tasks.filter(t => t.status === 'in-progress').length,
    completed: tasks.filter(t => t.status === 'completed').length,
    pendingApproval: tasks.filter(t => t.status === 'pending-client-approval').length,
    approved: tasks.filter(t => t.status === 'approved').length,
    posted: tasks.filter(t => t.status === 'posted').length,
    revisionRequired: tasks.filter(t => t.status === 'revision-required').length
  };

  const isTaskOverdue = (deadline) => {
    if (!deadline) return false;
    return new Date(deadline) < new Date() && new Date(deadline).toDateString() !== new Date().toDateString();
  };

  // Employee Login Modal
  if (showNameSelector) {
    return (
      <div className="dashboard">
        <ToastContainer toasts={toasts} removeToast={removeToast} />
        <div style={{
          display: 'flex',
          justifyContent: 'center',
          alignItems: 'center',
          minHeight: '100vh',
          background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)'
        }}>
          <div style={{
            background: 'white',
            borderRadius: '24px',
            padding: '48px',
            maxWidth: '450px',
            width: '90%',
            boxShadow: '0 25px 50px -12px rgba(0, 0, 0, 0.25)'
          }}>
            <div style={{ textAlign: 'center', marginBottom: '32px' }}>
              <div style={{
                width: '80px',
                height: '80px',
                background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                borderRadius: '50%',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                margin: '0 auto 20px',
                boxShadow: '0 8px 20px rgba(102, 126, 234, 0.3)'
              }}>
                <User size={40} color="white" />
              </div>
              <h2 style={{
                margin: '0 0 8px 0',
                fontSize: '28px',
                fontWeight: '700',
                color: '#1f2937'
              }}>Employee Login</h2>
              <p style={{
                margin: 0,
                fontSize: '15px',
                color: '#6b7280'
              }}>Enter your credentials to continue</p>
            </div>

            <form onSubmit={handleLogin}>
              <div style={{ marginBottom: '20px' }}>
                <label style={{
                  display: 'block',
                  marginBottom: '8px',
                  fontSize: '14px',
                  fontWeight: '600',
                  color: '#374151'
                }}>Email Address</label>
                <input
                  type="email"
                  value={loginEmail}
                  onChange={(e) => setLoginEmail(e.target.value)}
                  placeholder="Enter your email"
                  required
                  style={{
                    width: '100%',
                    padding: '14px 16px',
                    border: '2px solid #e5e7eb',
                    borderRadius: '12px',
                    fontSize: '15px',
                    outline: 'none',
                    transition: 'border-color 0.2s',
                    boxSizing: 'border-box'
                  }}
                  onFocus={(e) => e.target.style.borderColor = '#667eea'}
                  onBlur={(e) => e.target.style.borderColor = '#e5e7eb'}
                />
              </div>

              <div style={{ marginBottom: '24px' }}>
                <label style={{
                  display: 'block',
                  marginBottom: '8px',
                  fontSize: '14px',
                  fontWeight: '600',
                  color: '#374151'
                }}>Password</label>
                <input
                  type="password"
                  value={loginPassword}
                  onChange={(e) => setLoginPassword(e.target.value)}
                  placeholder="Enter your password"
                  required
                  style={{
                    width: '100%',
                    padding: '14px 16px',
                    border: '2px solid #e5e7eb',
                    borderRadius: '12px',
                    fontSize: '15px',
                    outline: 'none',
                    transition: 'border-color 0.2s',
                    boxSizing: 'border-box'
                  }}
                  onFocus={(e) => e.target.style.borderColor = '#667eea'}
                  onBlur={(e) => e.target.style.borderColor = '#e5e7eb'}
                />
              </div>

              {loginError && (
                <div style={{
                  background: '#fee2e2',
                  border: '1px solid #fecaca',
                  borderRadius: '8px',
                  padding: '12px',
                  marginBottom: '20px',
                  display: 'flex',
                  alignItems: 'center',
                  gap: '8px'
                }}>
                  <AlertCircle size={18} color="#dc2626" />
                  <span style={{ fontSize: '14px', color: '#dc2626', fontWeight: '500' }}>
                    {loginError}
                  </span>
                </div>
              )}

              <button
                type="submit"
                style={{
                  width: '100%',
                  background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                  color: 'white',
                  border: 'none',
                  borderRadius: '12px',
                  padding: '16px',
                  fontSize: '16px',
                  fontWeight: '600',
                  cursor: 'pointer',
                  transition: 'all 0.3s ease',
                  boxShadow: '0 4px 12px rgba(102, 126, 234, 0.3)'
                }}
                onMouseEnter={(e) => {
                  e.target.style.transform = 'translateY(-2px)';
                  e.target.style.boxShadow = '0 8px 20px rgba(102, 126, 234, 0.4)';
                }}
                onMouseLeave={(e) => {
                  e.target.style.transform = 'translateY(0)';
                  e.target.style.boxShadow = '0 4px 12px rgba(102, 126, 234, 0.3)';
                }}
              >
                Login
              </button>
            </form>

            <div style={{
              marginTop: '24px',
              padding: '16px',
              background: '#f9fafb',
              borderRadius: '12px',
              border: '1px solid #e5e7eb'
            }}>
              <p style={{
                margin: 0,
                fontSize: '13px',
                color: '#6b7280',
                textAlign: 'center',
                lineHeight: '1.5'
              }}>
                <strong style={{ color: '#374151' }}>Note:</strong> Use the email and password provided by your Production Incharge
              </p>
            </div>
          </div>
        </div>
      </div>
    );
  }

  return (
    <div className={`employee-dashboard ${currentDepartment === 'video' ? 'video-theme' : currentDepartment === 'graphics' ? 'graphics-theme' : ''}`}>
      <ToastContainer toasts={toasts} removeToast={removeToast} />

      {/* Revision Notification Popup - Only show for video and graphics employees */}
      {employeeName && (currentDepartment === 'video' || currentDepartment === 'graphics') && (
        <RevisionNotificationPopup
          employeeName={employeeName}
          department={currentDepartment}
        />
      )}

      {/* Sidebar Navigation */}
      <div className="employee-sidebar">
        <div className="employee-sidebar-header">
          <div className="employee-sidebar-logo">
            <div className="employee-sidebar-logo-icon">
              {currentDepartment === 'video' && <Video size={24} />}
              {currentDepartment === 'graphics' && <Image size={24} />}
              {!currentDepartment && <User size={24} />}
            </div>
            <div className="employee-sidebar-logo-text">
              <h2>
                {currentDepartment === 'video' && 'Video'}
                {currentDepartment === 'graphics' && 'Graphics'}
                {currentDepartment === 'social-media' && 'Social Media'}
                {!currentDepartment && 'Employee'}
              </h2>
              <p>Employee</p>
            </div>
          </div>
        </div>

        <nav className="employee-sidebar-nav">
          <div className="employee-sidebar-section">
            <h3 className="employee-sidebar-section-title">Main</h3>
            <ul className="employee-sidebar-menu">
              <li className="employee-sidebar-menu-item">
                <button
                  onClick={() => {
                    setShowReports(false);
                  }}
                  className={`employee-sidebar-menu-link ${!showReports ? 'active' : ''}`}
                  style={{
                    border: 'none',
                    background: !showReports ? 'rgba(255, 255, 255, 0.1)' : 'none',
                    width: '100%',
                    textAlign: 'left',
                    cursor: 'pointer',
                    color: 'inherit',
                    font: 'inherit'
                  }}
                >
                  <div className="employee-sidebar-menu-icon">
                    <LayoutDashboard size={20} />
                  </div>
                  My Tasks
                </button>
              </li>
              <li className="employee-sidebar-menu-item">
                <button
                  onClick={() => {
                    setShowReports(!showReports);
                  }}
                  className={`employee-sidebar-menu-link ${showReports ? 'active' : ''}`}
                  style={{
                    border: 'none',
                    background: showReports ? 'rgba(255, 255, 255, 0.1)' : 'none',
                    width: '100%',
                    textAlign: 'left',
                    cursor: 'pointer',
                    color: 'inherit',
                    font: 'inherit'
                  }}
                >
                  <div className="employee-sidebar-menu-icon">
                    <BarChart3 size={20} />
                  </div>
                  Reports
                </button>
              </li>
            </ul>
          </div>
        </nav>

        {/* User Profile Section */}
        <div className="employee-sidebar-user">
          <div className="employee-sidebar-user-info">
            <div className="employee-sidebar-user-avatar">
              {employeeName ? employeeName.charAt(0).toUpperCase() : 'E'}
            </div>
            <div className="employee-sidebar-user-details">
              <h4>{employeeName || 'Employee'}</h4>
              <p>
                {currentDepartment === 'video' && 'Video Team'}
                {currentDepartment === 'graphics' && 'Graphics Team'}
                {currentDepartment === 'social-media' && 'Social Media Team'}
                {!currentDepartment && 'Team Member'}
              </p>
            </div>
          </div>
          <button onClick={handleLogout} className="employee-btn employee-btn-logout" style={{ marginTop: '12px', width: '100%' }}>
            <LogOut size={16} /> Logout
          </button>
        </div>
      </div>

      {/* Main Content Area */}
      <div className="employee-main-content">
        {/* Page Header - Hidden when Reports is active */}
        {!showReports && (
          <>
            <div className="employee-header">
              <div className="employee-header-content">
                <div className="employee-header-left">
                  <div className="employee-header-title">
                    <h1>
                      {currentDepartment === 'video' && 'ðŸ“¹ Video Employee Dashboard'}
                      {currentDepartment === 'graphics' && 'ðŸŽ¨ Graphics Employee Dashboard'}
                      {currentDepartment === 'social-media' && 'ðŸ“± Social Media Employee Dashboard'}
                      {!currentDepartment && 'My Tasks Dashboard'}
                    </h1>
                    <p>Welcome, {employeeName || 'Employee'}</p>
                  </div>
                </div>
            <div className="employee-header-right">
              <div style={{
                display: 'flex',
                alignItems: 'center',
                gap: '12px',
                padding: '8px 16px',
                background: 'white',
                borderRadius: '8px',
                border: '1px solid #e5e7eb',
                boxShadow: '0 1px 3px rgba(0,0,0,0.1)'
              }}>
                <Calendar size={18} style={{ color: '#6b7280' }} />
                <label style={{ fontSize: '14px', fontWeight: '500', color: '#374151' }}>Month:</label>
                <input
                  type="month"
                  value={selectedMonth}
                  onChange={(e) => setSelectedMonth(e.target.value)}
                  style={{
                    padding: '6px 8px',
                    border: '1px solid #d1d5db',
                    borderRadius: '6px',
                    fontSize: '14px',
                    outline: 'none',
                    cursor: 'pointer'
                  }}
                />
                <span style={{
                  fontSize: '13px',
                  color: '#6b7280',
                  fontWeight: '500',
                  marginLeft: '8px'
                }}>
                  {new Date(selectedMonth + '-01').toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}
                </span>
              </div>
            </div>
          </div>
        </div>

        {/* Statistics Cards - Clickable */}
        <div style={{
          display: 'grid',
          gridTemplateColumns: 'repeat(4, 1fr)',
          gap: '16px',
          marginBottom: '24px',
          padding: '0'
        }}>
          {/* Total Tasks */}
          <div
            onClick={() => handleStatCardClick('all')}
            style={{
              background: activeFilter === 'all'
                ? 'linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%)'
                : 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
              borderRadius: '12px',
              padding: '32px 24px',
              color: 'white',
              boxShadow: activeFilter === 'all'
                ? '0 8px 20px rgba(102,126,234,0.4)'
                : '0 4px 12px rgba(102,126,234,0.2)',
              transition: 'all 0.3s ease',
              cursor: 'pointer',
              transform: activeFilter === 'all' ? 'translateY(-4px) scale(1.02)' : 'translateY(0)',
              position: 'relative'
            }}
            onMouseEnter={(e) => {
              e.currentTarget.style.transform = 'translateY(-4px) scale(1.02)';
              e.currentTarget.style.boxShadow = '0 8px 20px rgba(102,126,234,0.3)';
            }}
            onMouseLeave={(e) => {
              if (activeFilter !== 'all') {
                e.currentTarget.style.transform = 'translateY(0)';
                e.currentTarget.style.boxShadow = '0 4px 12px rgba(102,126,234,0.2)';
              } else {
                e.currentTarget.style.transform = 'translateY(-4px) scale(1.02)';
              }
            }}>
            {activeFilter === 'all' && (
              <div style={{
                position: 'absolute',
                top: '12px',
                right: '12px',
                backgroundColor: 'rgba(255,255,255,0.25)',
                borderRadius: '50%',
                width: '20px',
                height: '20px',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                fontSize: '11px',
                fontWeight: 'bold'
              }}>
                âœ“
              </div>
            )}
            <div style={{ fontSize: '48px', fontWeight: '700', lineHeight: 1, marginBottom: '12px' }}>
              {stats.total}
            </div>
            <div style={{ fontSize: '13px', fontWeight: '600', textTransform: 'uppercase', letterSpacing: '1px', opacity: 0.95 }}>
              TOTAL TASKS
            </div>
          </div>

          {/* In Progress */}
          <div
            onClick={() => handleStatCardClick('in-progress')}
            style={{
              background: activeFilter === 'in-progress'
                ? 'linear-gradient(135deg, #5a9bd4 0%, #0770c1 100%)'
                : 'linear-gradient(135deg, #74b9ff 0%, #0984e3 100%)',
              borderRadius: '16px',
              padding: '28px 20px',
              color: 'white',
              boxShadow: activeFilter === 'in-progress'
                ? '0 8px 20px rgba(116,185,255,0.4)'
                : '0 4px 12px rgba(116,185,255,0.2)',
              transition: 'all 0.3s ease',
              cursor: 'pointer',
              transform: activeFilter === 'in-progress' ? 'translateY(-4px) scale(1.02)' : 'translateY(0)',
              position: 'relative'
            }}
            onMouseEnter={(e) => {
              e.currentTarget.style.transform = 'translateY(-4px) scale(1.02)';
              e.currentTarget.style.boxShadow = '0 8px 20px rgba(116,185,255,0.3)';
            }}
            onMouseLeave={(e) => {
              if (activeFilter !== 'in-progress') {
                e.currentTarget.style.transform = 'translateY(0)';
                e.currentTarget.style.boxShadow = '0 4px 12px rgba(116,185,255,0.2)';
              } else {
                e.currentTarget.style.transform = 'translateY(-4px) scale(1.02)';
              }
            }}>
            {activeFilter === 'in-progress' && (
              <div style={{
                position: 'absolute',
                top: '12px',
                right: '12px',
                backgroundColor: 'rgba(255,255,255,0.25)',
                borderRadius: '50%',
                width: '20px',
                height: '20px',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                fontSize: '11px',
                fontWeight: 'bold'
              }}>
                âœ“
              </div>
            )}
            <div style={{ fontSize: '42px', fontWeight: '700', lineHeight: 1, marginBottom: '8px' }}>
              {stats.inProgress}
            </div>
            <div style={{ fontSize: '14px', fontWeight: '600', textTransform: 'uppercase', letterSpacing: '0.5px' }}>
              IN PROGRESS
            </div>
          </div>

          {/* Completed */}
          <div
            onClick={() => handleStatCardClick('completed')}
            style={{
              background: activeFilter === 'completed'
                ? 'linear-gradient(135deg, #4a9625 0%, #96d9b8 100%)'
                : 'linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%)',
              borderRadius: '16px',
              padding: '28px 20px',
              color: 'white',
              boxShadow: activeFilter === 'completed'
                ? '0 8px 20px rgba(86,171,47,0.4)'
                : '0 4px 12px rgba(86,171,47,0.2)',
              transition: 'all 0.3s ease',
              cursor: 'pointer',
              transform: activeFilter === 'completed' ? 'translateY(-4px) scale(1.02)' : 'translateY(0)',
              position: 'relative'
            }}
            onMouseEnter={(e) => {
              e.currentTarget.style.transform = 'translateY(-4px) scale(1.02)';
              e.currentTarget.style.boxShadow = '0 8px 20px rgba(86,171,47,0.3)';
            }}
            onMouseLeave={(e) => {
              if (activeFilter !== 'completed') {
                e.currentTarget.style.transform = 'translateY(0)';
                e.currentTarget.style.boxShadow = '0 4px 12px rgba(86,171,47,0.2)';
              } else {
                e.currentTarget.style.transform = 'translateY(-4px) scale(1.02)';
              }
            }}>
            {activeFilter === 'completed' && (
              <div style={{
                position: 'absolute',
                top: '12px',
                right: '12px',
                backgroundColor: 'rgba(255,255,255,0.25)',
                borderRadius: '50%',
                width: '20px',
                height: '20px',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                fontSize: '11px',
                fontWeight: 'bold'
              }}>
                âœ“
              </div>
            )}
            <div style={{ fontSize: '42px', fontWeight: '700', lineHeight: 1, marginBottom: '8px' }}>
              {stats.completed}
            </div>
            <div style={{ fontSize: '14px', fontWeight: '600', textTransform: 'uppercase', letterSpacing: '0.5px' }}>
              COMPLETED
            </div>
          </div>

          {/* Pending Approval */}
          <div
            onClick={() => handleStatCardClick('pending-client-approval')}
            style={{
              background: activeFilter === 'pending-client-approval'
                ? 'linear-gradient(135deg, #e55555 0%, #d44812 100%)'
                : 'linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%)',
              borderRadius: '16px',
              padding: '28px 20px',
              color: 'white',
              boxShadow: activeFilter === 'pending-client-approval'
                ? '0 8px 20px rgba(255,107,107,0.4)'
                : '0 4px 12px rgba(255,107,107,0.2)',
              transition: 'all 0.3s ease',
              cursor: 'pointer',
              transform: activeFilter === 'pending-client-approval' ? 'translateY(-4px) scale(1.02)' : 'translateY(0)',
              position: 'relative'
            }}
            onMouseEnter={(e) => {
              e.currentTarget.style.transform = 'translateY(-4px) scale(1.02)';
              e.currentTarget.style.boxShadow = '0 8px 20px rgba(255,107,107,0.3)';
            }}
            onMouseLeave={(e) => {
              if (activeFilter !== 'pending-client-approval') {
                e.currentTarget.style.transform = 'translateY(0)';
                e.currentTarget.style.boxShadow = '0 4px 12px rgba(255,107,107,0.2)';
              } else {
                e.currentTarget.style.transform = 'translateY(-4px) scale(1.02)';
              }
            }}>
            {activeFilter === 'pending-client-approval' && (
              <div style={{
                position: 'absolute',
                top: '12px',
                right: '12px',
                backgroundColor: 'rgba(255,255,255,0.25)',
                borderRadius: '50%',
                width: '20px',
                height: '20px',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                fontSize: '11px',
                fontWeight: 'bold'
              }}>
                âœ“
              </div>
            )}
            <div style={{ fontSize: '42px', fontWeight: '700', lineHeight: 1, marginBottom: '8px' }}>
              {stats.pendingApproval}
            </div>
            <div style={{ fontSize: '14px', fontWeight: '600', textTransform: 'uppercase', letterSpacing: '0.5px' }}>
              PENDING APPROVAL
            </div>
          </div>

          {/* Approved */}
          <div
            onClick={() => handleStatCardClick('approved')}
            style={{
              background: activeFilter === 'approved'
                ? 'linear-gradient(135deg, #17b584 0%, #4dd9b2 100%)'
                : 'linear-gradient(135deg, #1dd1a1 0%, #55efc4 100%)',
              borderRadius: '16px',
              padding: '28px 20px',
              color: 'white',
              boxShadow: activeFilter === 'approved'
                ? '0 8px 20px rgba(0,184,148,0.4)'
                : '0 4px 12px rgba(0,184,148,0.2)',
              transition: 'all 0.3s ease',
              cursor: 'pointer',
              transform: activeFilter === 'approved' ? 'translateY(-4px) scale(1.02)' : 'translateY(0)',
              position: 'relative'
            }}
            onMouseEnter={(e) => {
              e.currentTarget.style.transform = 'translateY(-4px) scale(1.02)';
              e.currentTarget.style.boxShadow = '0 8px 20px rgba(0,184,148,0.3)';
            }}
            onMouseLeave={(e) => {
              if (activeFilter !== 'approved') {
                e.currentTarget.style.transform = 'translateY(0)';
                e.currentTarget.style.boxShadow = '0 4px 12px rgba(0,184,148,0.2)';
              } else {
                e.currentTarget.style.transform = 'translateY(-4px) scale(1.02)';
              }
            }}>
            {activeFilter === 'approved' && (
              <div style={{
                position: 'absolute',
                top: '12px',
                right: '12px',
                backgroundColor: 'rgba(255,255,255,0.25)',
                borderRadius: '50%',
                width: '20px',
                height: '20px',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                fontSize: '11px',
                fontWeight: 'bold'
              }}>
                âœ“
              </div>
            )}
            <div style={{ fontSize: '42px', fontWeight: '700', lineHeight: 1, marginBottom: '8px' }}>
              {stats.approved}
            </div>
            <div style={{ fontSize: '14px', fontWeight: '600', textTransform: 'uppercase', letterSpacing: '0.5px' }}>
              APPROVED
            </div>
          </div>

          {/* Posted */}
          <div
            onClick={() => handleStatCardClick('posted')}
            style={{
              background: activeFilter === 'posted'
                ? 'linear-gradient(135deg, #d81b60 0%, #f06292 100%)'
                : 'linear-gradient(135deg, #e91e63 0%, #f48fb1 100%)',
              borderRadius: '16px',
              padding: '28px 20px',
              color: 'white',
              boxShadow: activeFilter === 'posted'
                ? '0 8px 20px rgba(233,30,99,0.4)'
                : '0 4px 12px rgba(233,30,99,0.2)',
              transition: 'all 0.3s ease',
              cursor: 'pointer',
              transform: activeFilter === 'posted' ? 'translateY(-4px) scale(1.02)' : 'translateY(0)',
              position: 'relative'
            }}
            onMouseEnter={(e) => {
              e.currentTarget.style.transform = 'translateY(-4px) scale(1.02)';
              e.currentTarget.style.boxShadow = '0 8px 20px rgba(233,30,99,0.3)';
            }}
            onMouseLeave={(e) => {
              if (activeFilter !== 'posted') {
                e.currentTarget.style.transform = 'translateY(0)';
                e.currentTarget.style.boxShadow = '0 4px 12px rgba(233,30,99,0.2)';
              } else {
                e.currentTarget.style.transform = 'translateY(-4px) scale(1.02)';
              }
            }}>
            {activeFilter === 'posted' && (
              <div style={{
                position: 'absolute',
                top: '12px',
                right: '12px',
                backgroundColor: 'rgba(255,255,255,0.25)',
                borderRadius: '50%',
                width: '20px',
                height: '20px',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                fontSize: '11px',
                fontWeight: 'bold'
              }}>
                âœ“
              </div>
            )}
            <div style={{ fontSize: '42px', fontWeight: '700', lineHeight: 1, marginBottom: '8px' }}>
              {stats.posted}
            </div>
            <div style={{ fontSize: '14px', fontWeight: '600', textTransform: 'uppercase', letterSpacing: '0.5px' }}>
              POSTED
            </div>
          </div>

          {/* Revision Required */}
          <div
            onClick={() => handleStatCardClick('revision-required')}
            style={{
              background: activeFilter === 'revision-required'
                ? 'linear-gradient(135deg, #6a4190 0%, #5a6fd8 100%)'
                : 'linear-gradient(135deg, #764ba2 0%, #667eea 100%)',
              borderRadius: '16px',
              padding: '28px 20px',
              color: 'white',
              boxShadow: activeFilter === 'revision-required'
                ? '0 8px 20px rgba(118,75,162,0.4)'
                : '0 4px 12px rgba(118,75,162,0.2)',
              transition: 'all 0.3s ease',
              cursor: 'pointer',
              transform: activeFilter === 'revision-required' ? 'translateY(-4px) scale(1.02)' : 'translateY(0)',
              position: 'relative'
            }}
            onMouseEnter={(e) => {
              e.currentTarget.style.transform = 'translateY(-4px) scale(1.02)';
              e.currentTarget.style.boxShadow = '0 8px 20px rgba(118,75,162,0.3)';
            }}
            onMouseLeave={(e) => {
              if (activeFilter !== 'revision-required') {
                e.currentTarget.style.transform = 'translateY(0)';
                e.currentTarget.style.boxShadow = '0 4px 12px rgba(118,75,162,0.2)';
              } else {
                e.currentTarget.style.transform = 'translateY(-4px) scale(1.02)';
              }
            }}>
            {activeFilter === 'revision-required' && (
              <div style={{
                position: 'absolute',
                top: '12px',
                right: '12px',
                backgroundColor: 'rgba(255,255,255,0.25)',
                borderRadius: '50%',
                width: '20px',
                height: '20px',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                fontSize: '11px',
                fontWeight: 'bold'
              }}>
                âœ“
              </div>
            )}
            <div style={{ fontSize: '42px', fontWeight: '700', lineHeight: 1, marginBottom: '8px' }}>
              {stats.revisionRequired}
            </div>
            <div style={{ fontSize: '14px', fontWeight: '600', textTransform: 'uppercase', letterSpacing: '0.5px' }}>
              REVISION REQUIRED
            </div>
          </div>
        </div>

        {/* Daily Report and Team Performance Cards */}
        <div style={{
          display: 'grid',
          gridTemplateColumns: 'repeat(auto-fit, minmax(400px, 1fr))',
          gap: '24px',
          marginBottom: '32px'
        }}>
          {/* Daily Report Card */}
          <div className="employee-card daily-report-card" style={{
            background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
            borderRadius: '16px',
            padding: '24px',
            boxShadow: '0 4px 12px rgba(102,126,234,0.2)',
            border: 'none',
            color: 'white'
          }}>
            <div style={{
              display: 'flex',
              justifyContent: 'space-between',
              alignItems: 'flex-start',
              marginBottom: '20px',
              flexWrap: 'wrap',
              gap: '16px'
            }}>
              <div>
                <h2 style={{
                  fontSize: '20px',
                  fontWeight: '700',
                  margin: '0 0 8px 0',
                  color: 'white'
                }}>ðŸ“Š Daily Report</h2>
                <p style={{
                  fontSize: '14px',
                  margin: 0,
                  opacity: 0.9
                }}>
                  {new Date().toLocaleDateString('en-US', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                  })}
                </p>
              </div>
              <div style={{
                background: 'rgba(255,255,255,0.2)',
                padding: '8px 16px',
                borderRadius: '20px',
                fontSize: '14px',
                fontWeight: '600'
              }}>
                {currentDepartment === 'video' ? 'ðŸ“¹ Video' : currentDepartment === 'graphics' ? 'ðŸŽ¨ Graphics' : 'ðŸ“± Social Media'}
              </div>
            </div>

            <div style={{
              display: 'grid',
              gridTemplateColumns: 'repeat(2, 1fr)',
              gap: '16px',
              marginBottom: '20px'
            }}>
              {/* Today's Tasks */}
              <div style={{
                background: 'rgba(255,255,255,0.15)',
                padding: '16px',
                borderRadius: '12px',
                textAlign: 'center'
              }}>
                <div style={{
                  fontSize: '24px',
                  fontWeight: '700',
                  marginBottom: '4px'
                }}>
                  {(() => {
                    const today = new Date().toISOString().split('T')[0];
                    return tasks.filter(task =>
                      task.deadline === today || task.postDate === today
                    ).length;
                  })()}
                </div>
                <div style={{ fontSize: '14px', opacity: 0.9 }}>Today's Tasks</div>
              </div>

              {/* Completed Today */}
              <div style={{
                background: 'rgba(255,255,255,0.15)',
                padding: '16px',
                borderRadius: '12px',
                textAlign: 'center'
              }}>
                <div style={{
                  fontSize: '24px',
                  fontWeight: '700',
                  marginBottom: '4px'
                }}>
                  {(() => {
                    const today = new Date().toISOString().split('T')[0];
                    return tasks.filter(task =>
                      task.completedAt && task.completedAt.startsWith(today)
                    ).length;
                  })()}
                </div>
                <div style={{ fontSize: '14px', opacity: 0.9 }}>Completed</div>
              </div>

              {/* Overdue Tasks */}
              <div style={{
                background: 'rgba(255,255,255,0.15)',
                padding: '16px',
                borderRadius: '12px',
                textAlign: 'center'
              }}>
                <div style={{
                  fontSize: '24px',
                  fontWeight: '700',
                  marginBottom: '4px'
                }}>
                  {(() => {
                    const today = new Date();
                    return tasks.filter(task => {
                      if (!task.deadline) return false;
                      const deadline = new Date(task.deadline);
                      return deadline <= today && (task.status === 'assigned' || task.status === 'in-progress');
                    }).length;
                  })()}
                </div>
                <div style={{ fontSize: '14px', opacity: 0.9 }}>Overdue</div>
              </div>

              {/* Success Rate */}
              <div style={{
                background: 'rgba(255,255,255,0.15)',
                padding: '16px',
                borderRadius: '12px',
                textAlign: 'center'
              }}>
                <div style={{
                  fontSize: '24px',
                  fontWeight: '700',
                  marginBottom: '4px'
                }}>
                  {(() => {
                    const totalTasks = tasks.length;
                    const completedTasks = tasks.filter(t =>
                      t.status === 'completed' || t.status === 'approved' || t.status === 'posted'
                    ).length;
                    return totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;
                  })()}%
                </div>
                <div style={{ fontSize: '14px', opacity: 0.9 }}>Success Rate</div>
              </div>
            </div>

            {/* Quick Action */}
            <button
              onClick={() => {
                const today = new Date().toISOString().split('T')[0];
                const todayTasks = tasks.filter(task =>
                  task.deadline === today || task.postDate === today
                );
                if (todayTasks.length > 0) {
                  // Scroll to tasks section
                  const tasksSection = document.querySelector('.card.full-width');
                  if (tasksSection) {
                    tasksSection.scrollIntoView({
                      behavior: 'smooth',
                      block: 'start'
                    });
                  }
                } else {
                  alert('No tasks scheduled for today!');
                }
              }}
              style={{
                background: 'rgba(255,255,255,0.2)',
                border: '1px solid rgba(255,255,255,0.3)',
                color: 'white',
                padding: '12px 24px',
                borderRadius: '8px',
                fontSize: '14px',
                fontWeight: '600',
                cursor: 'pointer',
                transition: 'all 0.2s ease',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                gap: '8px',
                width: '100%'
              }}
              onMouseEnter={(e) => {
                e.target.style.background = 'rgba(255,255,255,0.3)';
                e.target.style.transform = 'translateY(-2px)';
              }}
              onMouseLeave={(e) => {
                e.target.style.background = 'rgba(255,255,255,0.2)';
                e.target.style.transform = 'translateY(0)';
              }}
            >
              ðŸŽ¯ View Today's Tasks
            </button>
          </div>

          {/* Team Performance Card */}
          <div className="employee-card team-performance-card" style={{
            background: 'linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%)',
            borderRadius: '16px',
            padding: '24px',
            boxShadow: '0 4px 12px rgba(86,171,47,0.2)',
            border: 'none',
            color: 'white'
          }}>
            <div style={{
              display: 'flex',
              justifyContent: 'space-between',
              alignItems: 'flex-start',
              marginBottom: '20px',
              flexWrap: 'wrap',
              gap: '16px'
            }}>
              <div>
                <h2 style={{
                  fontSize: '20px',
                  fontWeight: '700',
                  margin: '0 0 8px 0',
                  color: 'white'
                }}>ðŸ“ˆ Weekly Summary</h2>
                <p style={{
                  fontSize: '14px',
                  margin: 0,
                  opacity: 0.9
                }}>
                  {(() => {
                    const today = new Date();
                    const weekStart = new Date(today.setDate(today.getDate() - today.getDay()));
                    const weekEnd = new Date(today.setDate(today.getDate() - today.getDay() + 6));
                    return `${weekStart.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })} - ${weekEnd.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}`;
                  })()}
                </p>
              </div>
              <div style={{
                background: 'rgba(255,255,255,0.2)',
                padding: '8px 16px',
                borderRadius: '20px',
                fontSize: '14px',
                fontWeight: '600'
              }}>
                This Week
              </div>
            </div>

            <div style={{
              display: 'grid',
              gridTemplateColumns: 'repeat(2, 1fr)',
              gap: '16px',
              marginBottom: '20px'
            }}>
              {/* Weekly Tasks */}
              <div style={{
                background: 'rgba(255,255,255,0.15)',
                padding: '16px',
                borderRadius: '12px',
                textAlign: 'center'
              }}>
                <div style={{
                  fontSize: '24px',
                  fontWeight: '700',
                  marginBottom: '4px'
                }}>
                  {(() => {
                    const today = new Date();
                    const weekStart = new Date(today.setDate(today.getDate() - today.getDay()));
                    const weekEnd = new Date(today.setDate(today.getDate() - today.getDay() + 6));
                    return tasks.filter(task => {
                      if (!task.deadline && !task.postDate) return false;
                      const taskDate = new Date(task.deadline || task.postDate);
                      return taskDate >= weekStart && taskDate <= weekEnd;
                    }).length;
                  })()}
                </div>
                <div style={{ fontSize: '14px', opacity: 0.9 }}>Weekly Tasks</div>
              </div>

              {/* Completed This Week */}
              <div style={{
                background: 'rgba(255,255,255,0.15)',
                padding: '16px',
                borderRadius: '12px',
                textAlign: 'center'
              }}>
                <div style={{
                  fontSize: '24px',
                  fontWeight: '700',
                  marginBottom: '4px'
                }}>
                  {tasks.filter(t =>
                    t.status === 'completed' || t.status === 'approved' || t.status === 'posted'
                  ).length}
                </div>
                <div style={{ fontSize: '14px', opacity: 0.9 }}>Completed</div>
              </div>

              {/* In Progress */}
              <div style={{
                background: 'rgba(255,255,255,0.15)',
                padding: '16px',
                borderRadius: '12px',
                textAlign: 'center'
              }}>
                <div style={{
                  fontSize: '24px',
                  fontWeight: '700',
                  marginBottom: '4px'
                }}>
                  {tasks.filter(t => t.status === 'in-progress').length}
                </div>
                <div style={{ fontSize: '14px', opacity: 0.9 }}>In Progress</div>
              </div>

              {/* Personal Efficiency */}
              <div style={{
                background: 'rgba(255,255,255,0.15)',
                padding: '16px',
                borderRadius: '12px',
                textAlign: 'center'
              }}>
                <div style={{
                  fontSize: '24px',
                  fontWeight: '700',
                  marginBottom: '4px'
                }}>
                  {(() => {
                    const inProgress = tasks.filter(t => t.status === 'in-progress').length;
                    const completed = tasks.filter(t =>
                      t.status === 'completed' || t.status === 'approved' || t.status === 'posted'
                    ).length;
                    const total = inProgress + completed;
                    return total > 0 ? Math.round((completed / total) * 100) : 0;
                  })()}%
                </div>
                <div style={{ fontSize: '14px', opacity: 0.9 }}>My Efficiency</div>
              </div>
            </div>

            {/* Quick Action */}
            <button
              onClick={() => {
                // Scroll to tasks section
                const tasksSection = document.querySelector('.card.full-width');
                if (tasksSection) {
                  tasksSection.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                  });
                }
              }}
              style={{
                background: 'rgba(255,255,255,0.2)',
                border: '1px solid rgba(255,255,255,0.3)',
                color: 'white',
                padding: '12px 24px',
                borderRadius: '8px',
                fontSize: '14px',
                fontWeight: '600',
                cursor: 'pointer',
                transition: 'all 0.2s ease',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                gap: '8px',
                width: '100%'
              }}
              onMouseEnter={(e) => {
                e.target.style.background = 'rgba(255,255,255,0.3)';
                e.target.style.transform = 'translateY(-2px)';
              }}
              onMouseLeave={(e) => {
                e.target.style.background = 'rgba(255,255,255,0.2)';
                e.target.style.transform = 'translateY(0)';
              }}
            >
              ðŸ“‹ View All Tasks
            </button>
          </div>
        </div>

        {/* Tasks Table */}
        <div className="card full-width" style={{ marginBottom: '30px' }}>
          <div className="card-header" style={{ flexDirection: 'column', alignItems: 'flex-start' }}>
            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', width: '100%', marginBottom: '16px' }}>
              <div>
                <h2>My Tasks ({getSearchFilteredTasks().length})</h2>
                <p style={{ fontSize: '14px', color: '#666', margin: '5px 0 0 0' }}>Tasks assigned to you, organized by client. Select tasks to download report.</p>
              </div>
            </div>

            {/* Search Bar, View Toggle, and Download All Button */}
            <div style={{
              display: 'flex',
              alignItems: 'center',
              gap: '12px',
              width: '100%',
              flexWrap: 'wrap'
            }}>
              {/* Search Bar */}
              <div style={{
                display: 'flex',
                alignItems: 'center',
                gap: '8px',
                padding: '8px 16px',
                background: '#f8f9fa',
                borderRadius: '8px',
                border: '1px solid #e5e7eb',
                flex: '1',
                minWidth: '250px'
              }}>
                <Search size={18} style={{ color: '#6b7280' }} />
                <input
                  type="text"
                  placeholder="Search clients, tasks..."
                  value={searchQuery}
                  onChange={(e) => setSearchQuery(e.target.value)}
                  style={{
                    padding: '6px 8px',
                    border: 'none',
                    background: 'transparent',
                    fontSize: '14px',
                    flex: 1,
                    outline: 'none'
                  }}
                />
                {searchQuery && (
                  <button
                    onClick={() => setSearchQuery('')}
                    style={{
                      background: 'none',
                      border: 'none',
                      color: '#6b7280',
                      cursor: 'pointer',
                      fontSize: '18px',
                      padding: '0 4px',
                      fontWeight: 'bold'
                    }}
                  >
                    Ã—
                  </button>
                )}
              </div>

              {/* View Toggle Buttons */}
              <div style={{
                display: 'flex',
                gap: '4px',
                padding: '4px',
                background: '#f8f9fa',
                borderRadius: '8px',
                border: '1px solid #e5e7eb'
              }}>
                <button
                  onClick={() => {
                    setViewMode('list');
                    setSelectedClientForCardView(null);
                  }}
                  style={{
                    display: 'flex',
                    alignItems: 'center',
                    gap: '6px',
                    padding: '8px 16px',
                    backgroundColor: viewMode === 'list' ? '#3b82f6' : 'transparent',
                    color: viewMode === 'list' ? 'white' : '#6b7280',
                    border: 'none',
                    borderRadius: '6px',
                    cursor: 'pointer',
                    fontSize: '13px',
                    fontWeight: '600',
                    transition: 'all 0.2s ease'
                  }}
                >
                  <List size={16} />
                  List View
                </button>
                <button
                  onClick={() => {
                    setViewMode('card');
                    setSelectedClientForCardView(null);
                  }}
                  style={{
                    display: 'flex',
                    alignItems: 'center',
                    gap: '6px',
                    padding: '8px 16px',
                    backgroundColor: viewMode === 'card' ? '#3b82f6' : 'transparent',
                    color: viewMode === 'card' ? 'white' : '#6b7280',
                    border: 'none',
                    borderRadius: '6px',
                    cursor: 'pointer',
                    fontSize: '13px',
                    fontWeight: '600',
                    transition: 'all 0.2s ease'
                  }}
                >
                  <Grid size={16} />
                  Card View
                </button>
              </div>

              {/* Download All Reports Button - Hide when viewing specific client tasks in card view */}
              {!(viewMode === 'card' && selectedClientForCardView) && (
                <button
                  onClick={() => downloadAllClientsReport()}
                  style={{
                    display: 'flex',
                    alignItems: 'center',
                    gap: '8px',
                    padding: '10px 20px',
                    backgroundColor: '#3b82f6',
                    color: 'white',
                    border: 'none',
                    borderRadius: '8px',
                    cursor: 'pointer',
                    fontSize: '14px',
                    fontWeight: '600',
                    whiteSpace: 'nowrap',
                    transition: 'all 0.2s ease'
                  }}
                  onMouseEnter={(e) => e.target.style.backgroundColor = '#2563eb'}
                  onMouseLeave={(e) => e.target.style.backgroundColor = '#3b82f6'}
                >
                  <Download size={18} />
                  Download All Reports (PDF)
                </button>
              )}
            </div>

            {/* Search Results Info */}
            {searchQuery && (
              <div style={{
                padding: '12px 16px',
                backgroundColor: '#e3f2fd',
                borderRadius: '8px',
                marginTop: '16px',
                fontSize: '14px',
                color: '#1976d2'
              }}>
                Found {getSearchFilteredTasks().length} task(s) matching "{searchQuery}"
                {getSearchFilteredTasks().length !== filteredTasks.length && (
                  <span style={{ marginLeft: '8px', opacity: 0.8 }}>
                    (filtered from {filteredTasks.length} total)
                  </span>
                )}
              </div>
            )}
          </div>
          {getSearchFilteredTasks().length === 0 ? (
            <div className="empty-state">
              <p>{searchQuery ? `No tasks found matching "${searchQuery}"` : 'No tasks assigned to you yet.'}</p>
            </div>
          ) : viewMode === 'card' ? (
            /* Card View - Client Cards */
            selectedClientForCardView ? (
              /* Show tasks for selected client */
              <div style={{ padding: '20px' }}>
                {/* Back Button */}
                <button
                  onClick={() => setSelectedClientForCardView(null)}
                  style={{
                    padding: '10px 20px',
                    backgroundColor: '#3b82f6',
                    color: 'white',
                    border: 'none',
                    borderRadius: '8px',
                    cursor: 'pointer',
                    fontSize: '14px',
                    fontWeight: '600',
                    display: 'flex',
                    alignItems: 'center',
                    gap: '8px',
                    marginBottom: '20px'
                  }}
                >
                  â† Back to All Clients
                </button>

                {/* Client Header */}
                <div style={{
                  backgroundColor: 'white',
                  borderRadius: '12px',
                  boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
                  overflow: 'hidden',
                  marginBottom: '20px'
                }}>
                  <div style={{
                    padding: '20px',
                    background: currentDepartment === 'video'
                      ? 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)'
                      : currentDepartment === 'graphics'
                        ? 'linear-gradient(135deg, #74b9ff 0%, #0984e3 100%)'
                        : 'linear-gradient(135deg, #1dd1a1 0%, #55efc4 100%)',
                    color: 'white',
                    textAlign: 'center'
                  }}>
                    <h3 style={{ margin: 0, fontSize: '24px', fontWeight: '600' }}>
                      {selectedClientForCardView}
                    </h3>
                    <p style={{ margin: '8px 0 0 0', fontSize: '14px', opacity: 0.9 }}>
                      {groupTasksByClient(getSearchFilteredTasks())[selectedClientForCardView]?.length || 0} task(s)
                    </p>
                  </div>
                </div>

                {/* Task Cards Grid */}
                <div style={{
                  display: 'grid',
                  gridTemplateColumns: 'repeat(auto-fill, minmax(320px, 1fr))',
                  gap: '20px'
                }}>
                  {(groupTasksByClient(getSearchFilteredTasks())[selectedClientForCardView] || []).map(task => {
                    const gradientColors = currentDepartment === 'video'
                      ? 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)'
                      : currentDepartment === 'graphics'
                        ? 'linear-gradient(135deg, #74b9ff 0%, #0984e3 100%)'
                        : 'linear-gradient(135deg, #1dd1a1 0%, #55efc4 100%)';

                    const clientInitial = (task.clientName || 'U').charAt(0).toUpperCase();
                    const isOverdue = isTaskOverdue(task.deadline);

                    return (
                      <div
                        key={task.id}
                        style={{
                          backgroundColor: 'white',
                          borderRadius: '12px',
                          boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
                          overflow: 'hidden',
                          transition: 'all 0.3s ease',
                          border: '1px solid #e9ecef',
                          position: 'relative',
                          display: 'flex',
                          flexDirection: 'column',
                          height: '100%'
                        }}
                      >
                        {/* Overdue Badge - Top Right */}
                        {isOverdue && task.status !== 'completed' && task.status !== 'posted' && (
                          <div style={{
                            position: 'absolute',
                            top: '12px',
                            right: '12px',
                            backgroundColor: '#dc3545',
                            color: 'white',
                            padding: '4px 12px',
                            borderRadius: '12px',
                            fontSize: '11px',
                            fontWeight: 'bold',
                            zIndex: 10
                          }}>
                            OVERDUE
                          </div>
                        )}

                        {/* Notification Bell Icon for Revision - Below Overdue Badge */}
                        {task.revisionMessage && (
                          <button
                            onClick={() => {
                              setSelectedRevisionNote(task.revisionMessage);
                              setShowRevisionNoteModal(true);
                            }}
                            style={{
                              position: 'absolute',
                              top: isOverdue && task.status !== 'completed' && task.status !== 'posted' ? '48px' : '12px',
                              right: '12px',
                              backgroundColor: '#ffc107',
                              color: 'white',
                              border: 'none',
                              borderRadius: '50%',
                              width: '32px',
                              height: '32px',
                              display: 'flex',
                              alignItems: 'center',
                              justifyContent: 'center',
                              cursor: 'pointer',
                              zIndex: 10,
                              boxShadow: '0 2px 8px rgba(255, 193, 7, 0.4)',
                              transition: 'all 0.2s'
                            }}
                            onMouseEnter={(e) => {
                              e.target.style.transform = 'scale(1.1)';
                              e.target.style.boxShadow = '0 4px 12px rgba(255, 193, 7, 0.6)';
                            }}
                            onMouseLeave={(e) => {
                              e.target.style.transform = 'scale(1)';
                              e.target.style.boxShadow = '0 2px 8px rgba(255, 193, 7, 0.4)';
                            }}
                          >
                            <AlertCircle size={18} />
                          </button>
                        )}

                        {/* Checkbox - Top Left Corner */}
                        <input
                          type="checkbox"
                          checked={isTaskSelected(task.clientName, task.id)}
                          onChange={() => toggleTaskSelection(task.clientName, task.id)}
                          style={{
                            position: 'absolute',
                            top: '8px',
                            left: '8px',
                            width: '18px',
                            height: '18px',
                            cursor: 'pointer',
                            zIndex: 10,
                            accentColor: '#3b82f6'
                          }}
                        />

                        {/* Card Header with Gradient */}
                        <div style={{
                          background: gradientColors,
                          padding: '20px',
                          color: 'white',
                          display: 'flex',
                          alignItems: 'center',
                          flexShrink: 0,
                          gap: '12px'
                        }}>
                          <div style={{
                            width: '50px',
                            height: '50px',
                            borderRadius: '50%',
                            backgroundColor: 'rgba(255,255,255,0.3)',
                            display: 'flex',
                            alignItems: 'center',
                            justifyContent: 'center',
                            fontSize: '20px',
                            fontWeight: '700',
                            flexShrink: 0
                          }}>
                            {clientInitial}
                          </div>
                          <div style={{ flex: 1, minWidth: 0 }}>
                            <div style={{ fontSize: '16px', fontWeight: '600', marginBottom: '4px', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>
                              {task.taskName}
                            </div>
                            <div style={{ fontSize: '13px', opacity: 0.9 }}>
                              {task.clientName}
                            </div>
                          </div>
                        </div>

                        {/* Card Body - Info Grid */}
                        <div style={{ padding: '16px', backgroundColor: '#f8f9fa', flex: 1 }}>
                          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '12px', marginBottom: '12px' }}>
                            {/* Project Name */}
                            <div>
                              <div style={{ fontSize: '11px', color: '#6b7280', marginBottom: '4px' }}>Project</div>
                              <div style={{
                                padding: '6px 10px',
                                borderRadius: '6px',
                                fontSize: '12px',
                                fontWeight: '600',
                                backgroundColor: '#e3f2fd',
                                color: '#1976d2',
                                textAlign: 'center'
                              }}>
                                {task.projectName || 'N/A'}
                              </div>
                            </div>

                            {/* Deadline */}
                            <div>
                              <div style={{ fontSize: '11px', color: '#6b7280', marginBottom: '4px' }}>Due Date</div>
                              <div style={{
                                padding: '6px 10px',
                                borderRadius: '6px',
                                fontSize: '12px',
                                fontWeight: '600',
                                backgroundColor: isOverdue ? '#fee2e2' : '#f3f4f6',
                                color: isOverdue ? '#dc2626' : '#374151',
                                textAlign: 'center'
                              }}>
                                {task.deadline ? new Date(task.deadline).toLocaleDateString('en-US', { month: 'short', day: 'numeric' }) : 'Not set'}
                              </div>
                            </div>

                            {/* Revisions */}
                            <div>
                              <div style={{ fontSize: '11px', color: '#6b7280', marginBottom: '4px' }}>Revisions</div>
                              <div style={{
                                display: 'flex',
                                alignItems: 'center',
                                justifyContent: 'center',
                                padding: '6px',
                                borderRadius: '6px',
                                backgroundColor: 'white'
                              }}>
                                <span style={{
                                  display: 'inline-flex',
                                  alignItems: 'center',
                                  justifyContent: 'center',
                                  minWidth: '28px',
                                  height: '28px',
                                  borderRadius: '50%',
                                  fontSize: '14px',
                                  fontWeight: '700',
                                  backgroundColor: (task.revisionCount || 0) > 0 ? '#dc3545' : '#10b981',
                                  color: 'white'
                                }}>
                                  {task.revisionCount || 0}
                                </span>
                              </div>
                            </div>

                            {/* Department */}
                            <div>
                              <div style={{ fontSize: '11px', color: '#6b7280', marginBottom: '4px' }}>Department</div>
                              <div style={{
                                padding: '6px 10px',
                                borderRadius: '6px',
                                fontSize: '11px',
                                fontWeight: '600',
                                backgroundColor: getDepartmentColor(task.department),
                                color: 'white',
                                textAlign: 'center',
                                textTransform: 'uppercase'
                              }}>
                                {task.department}
                              </div>
                            </div>
                          </div>

                          {/* Assigned To */}
                          <div style={{ marginBottom: '12px' }}>
                            <div style={{ fontSize: '11px', color: '#6b7280', marginBottom: '4px' }}>Assigned To:</div>
                            <div style={{ fontSize: '13px', fontWeight: '600', color: '#374151' }}>
                              {task.assignedTo || 'Unassigned'}
                            </div>
                          </div>
                        </div>

                        {/* Card Footer - Status & Actions */}
                        <div style={{ padding: '16px', backgroundColor: 'white', flexShrink: 0 }}>
                          {/* Status Dropdown */}
                          <div style={{ marginBottom: '12px' }}>
                            <div style={{ fontSize: '11px', color: '#6b7280', marginBottom: '6px', textAlign: 'center' }}>Status:</div>
                            <select
                              value={task.status}
                              onChange={(e) => handleStatusChange(task.id, e.target.value)}
                              style={{
                                width: '100%',
                                padding: '8px 12px',
                                borderRadius: '8px',
                                border: '2px solid #e5e7eb',
                                fontSize: '12px',
                                fontWeight: '600',
                                cursor: 'pointer',
                                backgroundColor: getStatusColor(task.status),
                                color: 'white',
                                textAlign: 'center'
                              }}
                            >
                              <option value="assigned" style={{ backgroundColor: '#fff', color: '#333' }}>Assigned</option>
                              <option value="in-progress" style={{ backgroundColor: '#fff', color: '#333' }}>In Progress</option>
                              <option value="completed" style={{ backgroundColor: '#fff', color: '#333' }}>Completed</option>
                              <option value="pending-client-approval" style={{ backgroundColor: '#fff', color: '#333' }}>Pending Approval</option>
                              <option value="approved" style={{ backgroundColor: '#fff', color: '#333' }}>Approved</option>
                              <option value="posted" style={{ backgroundColor: '#fff', color: '#333' }}>Posted</option>
                              <option value="revision-required" style={{ backgroundColor: '#fff', color: '#333' }}>Revision Required</option>
                            </select>
                          </div>

                          {/* Action Buttons */}
                          <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>
                            {task.status === 'assigned' && (
                              <button
                                onClick={() => handleStartWork(task.id)}
                                style={{
                                  width: '100%',
                                  backgroundColor: '#3b82f6',
                                  color: 'white',
                                  border: 'none',
                                  padding: '10px 16px',
                                  borderRadius: '8px',
                                  cursor: 'pointer',
                                  fontSize: '13px',
                                  fontWeight: '600',
                                  display: 'flex',
                                  alignItems: 'center',
                                  justifyContent: 'center',
                                  gap: '6px'
                                }}
                              >
                                <PlayCircle size={14} /> Start Work
                              </button>
                            )}

                            {task.status === 'revision-required' && (
                              <button
                                onClick={() => handleStartRevision(task.id)}
                                style={{
                                  width: '100%',
                                  backgroundColor: '#f59e0b',
                                  color: 'white',
                                  border: 'none',
                                  padding: '10px 16px',
                                  borderRadius: '8px',
                                  cursor: 'pointer',
                                  fontSize: '13px',
                                  fontWeight: '600',
                                  display: 'flex',
                                  alignItems: 'center',
                                  justifyContent: 'center',
                                  gap: '6px'
                                }}
                              >
                                <PlayCircle size={14} /> Start Revision
                              </button>
                            )}

                            {/* Start Button - Shows when task is assigned or pending */}
                            {(task.status === 'assigned' || task.status === 'assigned-to-department' || task.status === 'pending' || task.status === 'approved') && (
                              <button
                                onClick={() => handleStartTask(task.id)}
                                style={{
                                  width: '100%',
                                  backgroundColor: '#3b82f6',
                                  color: 'white',
                                  border: 'none',
                                  padding: '10px 16px',
                                  borderRadius: '8px',
                                  cursor: 'pointer',
                                  fontSize: '13px',
                                  fontWeight: '600',
                                  display: 'flex',
                                  alignItems: 'center',
                                  justifyContent: 'center',
                                  gap: '6px',
                                  transition: 'all 0.2s'
                                }}
                                onMouseEnter={(e) => {
                                  e.target.style.backgroundColor = '#2563eb';
                                  e.target.style.transform = 'translateY(-2px)';
                                  e.target.style.boxShadow = '0 4px 12px rgba(59, 130, 246, 0.4)';
                                }}
                                onMouseLeave={(e) => {
                                  e.target.style.backgroundColor = '#3b82f6';
                                  e.target.style.transform = 'translateY(0)';
                                  e.target.style.boxShadow = 'none';
                                }}
                              >
                                <PlayCircle size={14} /> Start Task
                              </button>
                            )}

                            {/* Complete Button - Shows when task is in progress */}
                            {task.status === 'in-progress' && (
                              <button
                                onClick={() => handleMarkComplete(task.id)}
                                style={{
                                  width: '100%',
                                  backgroundColor: '#10b981',
                                  color: 'white',
                                  border: 'none',
                                  padding: '10px 16px',
                                  borderRadius: '8px',
                                  cursor: 'pointer',
                                  fontSize: '13px',
                                  fontWeight: '600',
                                  display: 'flex',
                                  alignItems: 'center',
                                  justifyContent: 'center',
                                  gap: '6px',
                                  transition: 'all 0.2s'
                                }}
                                onMouseEnter={(e) => {
                                  e.target.style.backgroundColor = '#059669';
                                  e.target.style.transform = 'translateY(-2px)';
                                  e.target.style.boxShadow = '0 4px 12px rgba(16, 185, 129, 0.4)';
                                }}
                                onMouseLeave={(e) => {
                                  e.target.style.backgroundColor = '#10b981';
                                  e.target.style.transform = 'translateY(0)';
                                  e.target.style.boxShadow = 'none';
                                }}
                              >
                                <CheckCircle size={14} /> Mark Complete
                              </button>
                            )}

                            {/* Send for Approval Button - Shows when task is completed */}
                            {task.status === 'completed' && (
                              <button
                                onClick={() => handleSendForApproval(task.id, task)}
                                style={{
                                  width: '100%',
                                  backgroundColor: '#8b5cf6',
                                  color: 'white',
                                  border: 'none',
                                  padding: '10px 16px',
                                  borderRadius: '8px',
                                  cursor: 'pointer',
                                  fontSize: '13px',
                                  fontWeight: '600',
                                  display: 'flex',
                                  alignItems: 'center',
                                  justifyContent: 'center',
                                  gap: '6px'
                                }}
                              >
                                <Send size={14} /> Send for Approval
                              </button>
                            )}

                            {(task.status === 'pending-client-approval' || task.status === 'approved' || task.status === 'posted') && (
                              <div style={{
                                width: '100%',
                                padding: '10px 16px',
                                backgroundColor: '#e7f3ff',
                                borderRadius: '8px',
                                fontSize: '13px',
                                color: '#0066cc',
                                fontWeight: '600',
                                textAlign: 'center',
                                display: 'flex',
                                alignItems: 'center',
                                justifyContent: 'center',
                                gap: '6px'
                              }}>
                                <CheckCircle size={14} /> {task.status === 'pending-client-approval' ? 'âœ“ Awaiting Approval' : task.status === 'approved' ? 'âœ“ Approved' : 'âœ“ Posted'}
                              </div>
                            )}
                          </div>
                        </div>
                      </div>
                    );
                  })}
                </div>
              </div>
            ) : (
              /* Show client cards */
              <div style={{ padding: '20px' }}>
                {/* Action Buttons Row */}
                <div style={{ marginBottom: '20px', display: 'flex', gap: '12px', alignItems: 'center', flexWrap: 'wrap' }}>
                  {/* Download All Button */}
                  <button
                    onClick={() => downloadAllClientsReport()}
                    style={{
                      padding: '10px 20px',
                      backgroundColor: '#3b82f6',
                      color: 'white',
                      border: 'none',
                      borderRadius: '8px',
                      cursor: 'pointer',
                      fontSize: '14px',
                      fontWeight: '600',
                      display: 'flex',
                      alignItems: 'center',
                      gap: '8px'
                    }}
                  >
                    ðŸ“¥ Download All
                  </button>
                </div>

                {/* Client Cards Grid */}
                <div style={{
                  display: 'grid',
                  gridTemplateColumns: 'repeat(auto-fill, minmax(320px, 1fr))',
                  gap: '20px'
                }}>
                  {Object.entries(groupTasksByClient(getSearchFilteredTasks())).map(([clientName, clientTasks]) => {
                    // Determine gradient color based on employee department
                    let gradientColors = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';

                    if (currentDepartment === 'video') {
                      gradientColors = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
                    } else if (currentDepartment === 'graphics') {
                      gradientColors = 'linear-gradient(135deg, #74b9ff 0%, #0984e3 100%)';
                    } else if (currentDepartment === 'social-media') {
                      gradientColors = 'linear-gradient(135deg, #1dd1a1 0%, #55efc4 100%)';
                    }

                    const clientInitial = (clientName || 'U').charAt(0).toUpperCase();
                    const totalTasks = clientTasks.length;
                    const completedTasks = clientTasks.filter(t => t.status === 'completed' || t.status === 'posted').length;
                    const inProgressTasks = clientTasks.filter(t => t.status === 'in-progress').length;

                    return (
                      <div
                        key={clientName}
                        onClick={() => setSelectedClientForCardView(clientName)}
                        style={{
                          backgroundColor: 'white',
                          borderRadius: '16px',
                          boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
                          overflow: 'hidden',
                          transition: 'all 0.3s ease',
                          cursor: 'pointer',
                          border: '1px solid #e9ecef'
                        }}
                        onMouseEnter={(e) => {
                          e.currentTarget.style.transform = 'translateY(-4px)';
                          e.currentTarget.style.boxShadow = '0 8px 16px rgba(0,0,0,0.15)';
                        }}
                        onMouseLeave={(e) => {
                          e.currentTarget.style.transform = 'translateY(0)';
                          e.currentTarget.style.boxShadow = '0 2px 8px rgba(0,0,0,0.1)';
                        }}
                      >
                        {/* Client Header */}
                        <div style={{
                          background: gradientColors,
                          padding: '24px 20px',
                          display: 'flex',
                          alignItems: 'center',
                          gap: '16px'
                        }}>
                          {/* Client Avatar */}
                          <div style={{
                            width: '60px',
                            height: '60px',
                            borderRadius: '50%',
                            background: 'rgba(255,255,255,0.3)',
                            display: 'flex',
                            alignItems: 'center',
                            justifyContent: 'center',
                            fontSize: '24px',
                            fontWeight: '700',
                            color: 'white',
                            flexShrink: 0
                          }}>
                            {clientInitial}
                          </div>

                          {/* Client Info */}
                          <div style={{ flex: 1, minWidth: 0 }}>
                            <h3 style={{
                              margin: 0,
                              fontSize: '18px',
                              fontWeight: '600',
                              color: 'white',
                              whiteSpace: 'nowrap',
                              overflow: 'hidden',
                              textOverflow: 'ellipsis'
                            }}>
                              {clientName}
                            </h3>
                            <p style={{
                              margin: '4px 0 0 0',
                              fontSize: '13px',
                              color: 'rgba(255,255,255,0.9)'
                            }}>
                              {totalTasks} task{totalTasks !== 1 ? 's' : ''}
                            </p>
                          </div>
                        </div>

                        {/* Task Stats */}
                        <div style={{
                          padding: '20px',
                          display: 'flex',
                          justifyContent: 'space-around',
                          gap: '12px'
                        }}>
                          {/* Total Tasks */}
                          <div style={{ textAlign: 'center', flex: 1 }}>
                            <div style={{
                              fontSize: '28px',
                              fontWeight: '700',
                              color: '#667eea',
                              marginBottom: '4px'
                            }}>
                              {totalTasks}
                            </div>
                            <div style={{
                              fontSize: '12px',
                              color: '#6b7280',
                              fontWeight: '500'
                            }}>
                              Total Tasks
                            </div>
                          </div>

                          {/* Completed */}
                          <div style={{ textAlign: 'center', flex: 1 }}>
                            <div style={{
                              fontSize: '28px',
                              fontWeight: '700',
                              color: '#10b981',
                              marginBottom: '4px'
                            }}>
                              {completedTasks}
                            </div>
                            <div style={{
                              fontSize: '12px',
                              color: '#6b7280',
                              fontWeight: '500'
                            }}>
                              Completed
                            </div>
                          </div>

                          {/* In Progress */}
                          <div style={{ textAlign: 'center', flex: 1 }}>
                            <div style={{
                              fontSize: '28px',
                              fontWeight: '700',
                              color: '#f59e0b',
                              marginBottom: '4px'
                            }}>
                              {inProgressTasks}
                            </div>
                            <div style={{
                              fontSize: '12px',
                              color: '#6b7280',
                              fontWeight: '500'
                            }}>
                              In Progress
                            </div>
                          </div>
                        </div>

                        {/* View Details Button */}
                        <div style={{
                          padding: '0 20px 20px 20px'
                        }}>
                          <div style={{
                            background: '#f3f4f6',
                            padding: '12px',
                            borderRadius: '8px',
                            textAlign: 'center',
                            fontSize: '13px',
                            color: '#6b7280',
                            fontWeight: '500'
                          }}>
                            Click to view all tasks
                          </div>
                        </div>
                      </div>
                    );
                  })}
                </div>
              </div>
            )
          ) : (
            /* List View - Grouped by Client */
            <div style={{ padding: '0' }}>
              {Object.entries(groupTasksByClient(getSearchFilteredTasks())).map(([clientName, clientGroup]) => {
                const isExpanded = expandedClients[clientName];
                const totalTasks = clientGroup.length;
                const completedTasks = clientGroup.filter(t => t.status === 'completed' || t.status === 'posted').length;
                const inProgressTasks = clientGroup.filter(t => t.status === 'in-progress').length;

                return (
                  <div key={clientName} style={{
                    backgroundColor: 'white',
                    borderRadius: '12px',
                    boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
                    overflow: 'hidden',
                    border: '1px solid #e9ecef',
                    marginBottom: '16px'
                  }}>
                    <div
                      onClick={() => toggleClientExpansion(clientName)}
                      style={{
                        padding: '20px',
                        background: currentDepartment === 'video'
                          ? 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)'
                          : currentDepartment === 'graphics'
                            ? 'linear-gradient(135deg, #74b9ff 0%, #0984e3 100%)'
                            : 'linear-gradient(135deg, #1dd1a1 0%, #55efc4 100%)',
                        color: 'white',
                        cursor: 'pointer',
                        display: 'flex',
                        justifyContent: 'space-between',
                        alignItems: 'center',
                        transition: 'all 0.2s ease'
                      }}
                    >
                      <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
                        <div style={{
                          backgroundColor: 'rgba(255,255,255,0.2)',
                          padding: '8px 12px',
                          borderRadius: '8px',
                          fontSize: '14px',
                          fontWeight: '600'
                        }}>
                          {totalTasks}
                        </div>
                        <div>
                          <h3 style={{ margin: 0, fontSize: '18px', fontWeight: '600' }}>
                            {clientName}
                          </h3>
                          <div style={{ fontSize: '14px', opacity: 0.9, marginTop: '4px' }}>
                            {totalTasks} task{totalTasks !== 1 ? 's' : ''} â€¢ {completedTasks} completed â€¢ {inProgressTasks} in progress
                          </div>
                        </div>
                      </div>
                      <div style={{
                        fontSize: '24px',
                        transform: isExpanded ? 'rotate(180deg)' : 'rotate(0deg)',
                        transition: 'transform 0.3s ease'
                      }}>
                        â–¼
                      </div>
                    </div>

                    {isExpanded && (
                      <div style={{ padding: '0' }}>
                        <table style={{
                          width: '100%',
                          borderCollapse: 'collapse'
                        }}>
                          <thead>
                            <tr style={{
                              backgroundColor: '#f8f9fa',
                              borderBottom: '2px solid #e9ecef'
                            }}>
                              <th style={{ padding: '12px 16px', textAlign: 'left', fontSize: '12px', fontWeight: '600', color: '#6c757d', textTransform: 'uppercase' }}>Task Name</th>
                              {currentDepartment !== 'video' && (
                                <th style={{ padding: '12px 16px', textAlign: 'center', fontSize: '12px', fontWeight: '600', color: '#6c757d', textTransform: 'uppercase' }}>Department</th>
                              )}
                              <th style={{ padding: '12px 16px', textAlign: 'center', fontSize: '12px', fontWeight: '600', color: '#6c757d', textTransform: 'uppercase' }}>Deadline</th>
                              <th style={{ padding: '12px 16px', textAlign: 'center', fontSize: '12px', fontWeight: '600', color: '#6c757d', textTransform: 'uppercase' }}>Start</th>
                              <th style={{ padding: '12px 16px', textAlign: 'center', fontSize: '12px', fontWeight: '600', color: '#6c757d', textTransform: 'uppercase' }}>Done</th>
                              <th style={{ padding: '12px 16px', textAlign: 'center', fontSize: '12px', fontWeight: '600', color: '#6c757d', textTransform: 'uppercase' }}>Revision Timeline</th>
                              <th style={{ padding: '12px 16px', textAlign: 'center', fontSize: '12px', fontWeight: '600', color: '#6c757d', textTransform: 'uppercase' }}>Status</th>
                              <th style={{ padding: '12px 16px', textAlign: 'center', fontSize: '12px', fontWeight: '600', color: '#6c757d', textTransform: 'uppercase' }}>Revisions</th>
                              <th style={{ padding: '12px 16px', textAlign: 'center', fontSize: '12px', fontWeight: '600', color: '#6c757d', textTransform: 'uppercase' }}>Actions</th>
                            </tr>
                          </thead>
                          <tbody>
                            {clientGroup.map(task => (
                              <tr key={task.id} style={{
                                borderBottom: '1px solid #f1f3f4'
                              }}>
                                <td style={{ padding: '12px 16px', textAlign: 'left', color: '#495057', fontSize: '14px' }}>
                                  <div style={{ display: 'flex', alignItems: 'flex-start', gap: '8px' }}>
                                    {getStatusIcon(task.status)}
                                    <div style={{ flex: 1 }}>
                                      <div style={{ fontWeight: '600', marginBottom: '4px' }}>{task.taskName}</div>
                                      {isTaskOverdue(task.deadline) && task.status !== 'posted' && task.status !== 'completed' && (
                                        <span style={{
                                          backgroundColor: '#dc3545',
                                          color: 'white',
                                          padding: '2px 6px',
                                          borderRadius: '4px',
                                          fontSize: '10px',
                                          fontWeight: 'bold',
                                          marginRight: '6px'
                                        }}>
                                          OVERDUE
                                        </span>
                                      )}
                                      {task.revisionMessage && (
                                        <div style={{
                                          marginTop: '8px',
                                          padding: '8px 12px',
                                          backgroundColor: '#fff3cd',
                                          border: '1px solid #ffc107',
                                          borderRadius: '6px',
                                          fontSize: '12px',
                                          color: '#856404'
                                        }}>
                                          <strong>âš ï¸ Revision Required:</strong> {task.revisionMessage}
                                        </div>
                                      )}
                                    </div>
                                  </div>
                                </td>
                                {currentDepartment !== 'video' && (
                                  <td style={{ padding: '12px 16px', textAlign: 'center' }}>
                                    <span style={{
                                      padding: '4px 8px',
                                      borderRadius: '12px',
                                      fontSize: '11px',
                                      fontWeight: '600',
                                      backgroundColor: getDepartmentColor(task.department) + '20',
                                      color: getDepartmentColor(task.department),
                                      textTransform: 'uppercase'
                                    }}>
                                      {task.department}
                                    </span>
                                  </td>
                                )}
                                <td style={{ padding: '12px 16px', textAlign: 'center', color: '#495057', fontSize: '13px' }}>
                                  {task.deadline ? (
                                    <span style={{
                                      display: 'inline-flex',
                                      alignItems: 'center',
                                      gap: '4px',
                                      color: isTaskOverdue(task.deadline) ? '#dc3545' : '#495057'
                                    }}>
                                      <Calendar size={14} />
                                      {new Date(task.deadline).toLocaleDateString()}
                                    </span>
                                  ) : '-'}
                                </td>
                                <td style={{ padding: '12px 16px', textAlign: 'center', color: '#495057', fontSize: '12px' }}>
                                  {task.startedAt ? (
                                    <div>
                                      <div style={{ fontWeight: '600', color: '#10b981' }}>
                                        {new Date(task.startedAt).toLocaleDateString()}
                                      </div>
                                      <div style={{ fontSize: '11px', color: '#6b7280' }}>
                                        {new Date(task.startedAt).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}
                                      </div>
                                    </div>
                                  ) : '-'}
                                </td>
                                <td style={{ padding: '12px 16px', textAlign: 'center', color: '#495057', fontSize: '12px' }}>
                                  {task.completedAt ? (
                                    <div>
                                      <div style={{ fontWeight: '600', color: '#8b5cf6' }}>
                                        {new Date(task.completedAt).toLocaleDateString()}
                                      </div>
                                      <div style={{ fontSize: '11px', color: '#6b7280' }}>
                                        {new Date(task.completedAt).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}
                                      </div>
                                    </div>
                                  ) : '-'}
                                </td>
                                <td style={{ padding: '12px 16px', textAlign: 'center', color: '#495057', fontSize: '11px' }}>
                                  {task.lastRevisionAt || task.submittedAt ? (
                                    <div style={{
                                      display: 'flex',
                                      flexDirection: 'column',
                                      gap: '8px',
                                      alignItems: 'center'
                                    }}>
                                      {task.lastRevisionAt && (
                                        <div style={{
                                          padding: '6px 10px',
                                          background: 'linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)',
                                          borderRadius: '6px',
                                          border: '1px solid #fbbf24',
                                          width: '100%'
                                        }}>
                                          <div style={{ fontWeight: '700', color: '#92400e', fontSize: '10px', marginBottom: '2px' }}>
                                            âš ï¸ REVISION
                                          </div>
                                          <div style={{ fontWeight: '600', color: '#78350f' }}>
                                            {new Date(task.lastRevisionAt).toLocaleDateString()}
                                          </div>
                                          <div style={{ fontSize: '10px', color: '#92400e' }}>
                                            {new Date(task.lastRevisionAt).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}
                                          </div>
                                        </div>
                                      )}
                                      {task.submittedAt && (
                                        <div style={{
                                          padding: '6px 10px',
                                          background: 'linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%)',
                                          borderRadius: '6px',
                                          border: '1px solid #60a5fa',
                                          width: '100%'
                                        }}>
                                          <div style={{ fontWeight: '700', color: '#1e40af', fontSize: '10px', marginBottom: '2px' }}>
                                            âœ“ SUBMITTED
                                          </div>
                                          <div style={{ fontWeight: '600', color: '#1e3a8a' }}>
                                            {new Date(task.submittedAt).toLocaleDateString()}
                                          </div>
                                          <div style={{ fontSize: '10px', color: '#1e40af' }}>
                                            {new Date(task.submittedAt).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}
                                          </div>
                                        </div>
                                      )}
                                    </div>
                                  ) : (
                                    <span style={{ color: '#9ca3af', fontStyle: 'italic' }}>No timeline</span>
                                  )}
                                </td>
                                <td style={{ padding: '12px 16px', textAlign: 'center' }}>
                                  <span style={{
                                    display: 'inline-block',
                                    padding: '8px 16px',
                                    borderRadius: '20px',
                                    fontSize: '12px',
                                    fontWeight: '700',
                                    backgroundColor: getStatusColor(task.status),
                                    color: 'white',
                                    textTransform: 'capitalize',
                                    whiteSpace: 'nowrap',
                                    boxShadow: '0 2px 4px rgba(0,0,0,0.1)'
                                  }}>
                                    {task.status?.replace(/-/g, ' ') || 'Unknown'}
                                  </span>
                                </td>
                                <td style={{ padding: '12px 16px', textAlign: 'center' }}>
                                  <span style={{
                                    display: 'inline-block',
                                    minWidth: '24px',
                                    height: '24px',
                                    lineHeight: '24px',
                                    borderRadius: '50%',
                                    fontSize: '12px',
                                    fontWeight: '700',
                                    backgroundColor: (task.revisionCount || 0) > 0 ? '#ff4757' : '#2ed573',
                                    color: 'white',
                                    textAlign: 'center'
                                  }}>
                                    {task.revisionCount || 0}
                                  </span>
                                </td>
                                <td style={{ padding: '12px 16px', textAlign: 'center' }}>
                                  <div style={{ display: 'flex', gap: '6px', justifyContent: 'center', flexWrap: 'wrap' }}>
                                    {task.status === 'assigned' && (
                                      <button
                                        onClick={() => handleStartWork(task.id)}
                                        style={{
                                          backgroundColor: '#3b82f6',
                                          color: 'white',
                                          border: 'none',
                                          padding: '6px 12px',
                                          borderRadius: '6px',
                                          cursor: 'pointer',
                                          fontSize: '12px',
                                          display: 'flex',
                                          alignItems: 'center',
                                          gap: '4px',
                                          fontWeight: '500'
                                        }}
                                      >
                                        <PlayCircle size={12} /> Start
                                      </button>
                                    )}

                                    {task.status === 'revision-required' && (
                                      <button
                                        onClick={() => handleStartRevision(task.id)}
                                        style={{
                                          backgroundColor: '#f59e0b',
                                          color: 'white',
                                          border: 'none',
                                          padding: '6px 12px',
                                          borderRadius: '6px',
                                          cursor: 'pointer',
                                          fontSize: '12px',
                                          display: 'flex',
                                          alignItems: 'center',
                                          gap: '4px',
                                          fontWeight: '500'
                                        }}
                                      >
                                        <PlayCircle size={12} /> Start Revision
                                      </button>
                                    )}

                                    {task.status === 'in-progress' && (
                                      <button
                                        onClick={() => handleMarkComplete(task.id)}
                                        style={{
                                          backgroundColor: '#10b981',
                                          color: 'white',
                                          border: 'none',
                                          padding: '6px 12px',
                                          borderRadius: '6px',
                                          cursor: 'pointer',
                                          fontSize: '12px',
                                          display: 'flex',
                                          alignItems: 'center',
                                          gap: '4px',
                                          fontWeight: '500'
                                        }}
                                      >
                                        <CheckCircle size={12} /> Complete
                                      </button>
                                    )}

                                    {task.status === 'completed' && (
                                      <button
                                        onClick={() => handleSendForApproval(task.id, task)}
                                        style={{
                                          backgroundColor: '#8b5cf6',
                                          color: 'white',
                                          border: 'none',
                                          padding: '6px 12px',
                                          borderRadius: '6px',
                                          cursor: 'pointer',
                                          fontSize: '12px',
                                          display: 'flex',
                                          alignItems: 'center',
                                          gap: '4px',
                                          fontWeight: '500'
                                        }}
                                      >
                                        <Send size={12} /> Send for Approval
                                      </button>
                                    )}

                                    {(task.status === 'pending-client-approval' || task.status === 'approved' || task.status === 'posted') && (
                                      <span style={{
                                        padding: '6px 12px',
                                        backgroundColor: '#e7f3ff',
                                        borderRadius: '6px',
                                        fontSize: '11px',
                                        color: '#0066cc',
                                        display: 'flex',
                                        alignItems: 'center',
                                        gap: '4px',
                                        fontWeight: '500'
                                      }}>
                                        <CheckCircle size={12} /> {task.status === 'pending-client-approval' ? 'Awaiting Approval' : task.status === 'approved' ? 'Approved' : 'Posted'}
                                      </span>
                                    )}
                                  </div>
                                </td>
                              </tr>
                            ))}
                          </tbody>
                        </table>
                      </div>
                    )}
                  </div>
                );
              })}
            </div>
          )}
        </div>
      </div>

      {/* Revision Note Modal */}
      {showRevisionNoteModal && (
        <div style={{
          position: 'fixed',
          top: 0,
          left: 0,
          right: 0,
          bottom: 0,
          backgroundColor: 'rgba(0,0,0,0.5)',
          display: 'flex',
          justifyContent: 'center',
          alignItems: 'center',
          zIndex: 2000
        }}>
          <div style={{
            backgroundColor: 'white',
            borderRadius: '16px',
            padding: '32px',
            maxWidth: '500px',
            width: '90%',
            boxShadow: '0 20px 60px rgba(0,0,0,0.3)'
          }}>
            <div style={{
              display: 'flex',
              alignItems: 'center',
              gap: '12px',
              marginBottom: '16px'
            }}>
              <div style={{
                backgroundColor: '#ffc107',
                borderRadius: '50%',
                width: '40px',
                height: '40px',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                color: 'white'
              }}>
                <AlertCircle size={24} />
              </div>
              <h3 style={{
                margin: 0,
                fontSize: '20px',
                fontWeight: '700',
                color: '#1f2937'
              }}>Revision Required</h3>
            </div>

            <div style={{
              padding: '16px',
              backgroundColor: '#fff3cd',
              border: '1px solid #ffc107',
              borderRadius: '8px',
              marginBottom: '24px'
            }}>
              <p style={{
                margin: 0,
                fontSize: '14px',
                color: '#856404',
                lineHeight: '1.6'
              }}>
                {selectedRevisionNote}
              </p>
            </div>

            <button
              onClick={() => {
                setShowRevisionNoteModal(false);
                setSelectedRevisionNote('');
              }}
              style={{
                width: '100%',
                padding: '12px 24px',
                background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                color: 'white',
                border: 'none',
                borderRadius: '8px',
                fontSize: '14px',
                fontWeight: '600',
                cursor: 'pointer'
              }}
            >
              Close
            </button>
          </div>
        </div>
      )}

      {/* Social Media Employee Selection Modal */}
      {showSocialMediaEmployeeModal && (
        <div style={{
          position: 'fixed',
          top: 0,
          left: 0,
          right: 0,
          bottom: 0,
          backgroundColor: 'rgba(0,0,0,0.5)',
          display: 'flex',
          justifyContent: 'center',
          alignItems: 'center',
          zIndex: 2000
        }}>
          <div style={{
            backgroundColor: 'white',
            borderRadius: '20px',
            padding: '40px',
            maxWidth: '500px',
            width: '90%',
            boxShadow: '0 25px 50px -12px rgba(0,0,0,0.25)'
          }}>
            <h3 style={{
              margin: '0 0 12px 0',
              fontSize: '24px',
              fontWeight: '700',
              color: '#1f2937',
              textAlign: 'center'
            }}>Select Social Media Employee</h3>
            <p style={{
              margin: '0 0 32px 0',
              fontSize: '14px',
              color: '#6b7280',
              textAlign: 'center'
            }}>Choose who will handle client approval for this task</p>

            <div style={{
              display: 'grid',
              gridTemplateColumns: 'repeat(2, 1fr)',
              gap: '12px',
              marginBottom: '24px'
            }}>
              {employees
                .filter(emp => emp.department === 'social-media' && emp.status === 'active')
                .map(emp => (
                  <button
                    key={emp.id}
                    onClick={() => handleSendToSocialMediaEmployee(emp.employeeName)}
                    style={{
                      background: 'linear-gradient(135deg, #1dd1a1 0%, #55efc4 100%)',
                      color: 'white',
                      border: 'none',
                      borderRadius: '12px',
                      padding: '16px 20px',
                      fontSize: '15px',
                      fontWeight: '600',
                      cursor: 'pointer',
                      transition: 'all 0.2s',
                      boxShadow: '0 4px 12px rgba(29, 209, 161, 0.3)'
                    }}
                    onMouseEnter={(e) => {
                      e.target.style.transform = 'translateY(-2px)';
                      e.target.style.boxShadow = '0 6px 16px rgba(29, 209, 161, 0.4)';
                    }}
                    onMouseLeave={(e) => {
                      e.target.style.transform = 'translateY(0)';
                      e.target.style.boxShadow = '0 4px 12px rgba(29, 209, 161, 0.3)';
                    }}
                  >
                    {emp.employeeName}
                  </button>
                ))}
            </div>

            <button
              onClick={() => {
                setShowSocialMediaEmployeeModal(false);
                setSelectedTaskForSending(null);
              }}
              style={{
                width: '100%',
                padding: '12px 24px',
                background: '#f3f4f6',
                color: '#374151',
                border: '1px solid #d1d5db',
                borderRadius: '12px',
                fontSize: '14px',
                fontWeight: '600',
                cursor: 'pointer'
              }}
            >
              Cancel
            </button>
          </div>
        </div>
      )}

          </>
        )}

        {/* Reports Section */}
        {showReports && (() => {
          const allMonthTasks = filteredTasks;
          const completedTasks = allMonthTasth;
) : 0;

;
}iv>
  )
    </div>    </d)()}
         }    );
 v>
        </di         </div>
               /table>
       <
         tbody> </         }
        ))                    
   </tr>                   
d>      </t            
      /A'}: 'NString() tecaleDane).toLotask.deadlie( new Dat.deadline ?  {task                >
        6b7280' }}'#r: 13px', coloe: 'Sizontnter', flign: 'ce', textAding: '12px{ pad<td style={                      /td>
             <            span>
  </                         se()}
oUpperCa, ' ').t/-/geplace( '').r.status ||{(task                                   }}>
                   91b1b'
400e' : '#9? '#92gress' n-pro== 'istatus =46' : task.' ? '#065f'completed= .status ==taskf' : #1e40aved' ? ''appro= atus ==6' : task.st065f4ted' ? '#tus === 'posor: task.sta         col                ,
   : '#fee2e2'#fef3c7' ss' ? 'in-progre === ' task.status '#d1fae5' :ompleted' ?== 'cs =tatu.stask' :  '#dbeafeproved' ?tus === 'apsk.sta1fae5' : ta ? '#d= 'posted'tus ==ask.sta troundColor:    backg                     600',
   ontWeight: '    f                ',
        ze: '11pxSiont       f                     px',
Radius: '12  border                          px 10px',
ing: '4        padd           
         style={{    <span               
        ter' }}>gn: 'cenxtAlite12px', ding: 'e={{ padyl<td st                     </td>
   || 'N/A'}taskName }>{task.937' }f2lor: '#113px', co: ' fontSize12px',adding: 'le={{ p <td sty                  >
     | 'N/A'}</tdclientName |7' }}>{task.: '#1f293px', colorontSize: '13x', f: '12pdingtyle={{ pad      <td s                  }>
fb' } : '#f9fafff'== 0 ? '#fff% 2 =olor: index ackgroundCf3f4', bx solid #f1tom: '1pderBote={{ bor} styltask.idy={tr ke   <                    => (
dex)in(task, hTasks.map(Mont       {all          dy>
    <tbo            head>
        </t      >
            </tr            
     adline</th>b7280' }}>De'#6or: , col600'ight: ', fontWe12px' '', fontSize:er 'centtextAlign:'12px', {{ padding: tyle=    <th s               
   >Status</th>6b7280' }}color: '#ht: '600', tWeigfonx', tSize: '12ponnter', ftAlign: 'ce2px', texpadding: '1h style={{       <t                </th>
>Task0' }}28'#6b7r: ', colo '600Weight:px', fontontSize: '12t', flefn: 'Alig textpx',padding: '12 style={{ th     <          h>
       ient</t' }}>Clb7280: '#6', coloreight: '600, fontWe: '12px'Siz font'left',lign: , textA2px'padding: '1h style={{        <t       
        b' }}>7elid #e5eom: '2px sottborderBo#f9fafb', ndColor: '{{ backgrou style=     <tr         ad>
             <the           
' }}>: 'collapseerCollapse'100%', bord{{ width: tyle=le s <tab         h3>
      </               y
 mar Sum    Task                    }}>
      937'
    olor: '#1f2         c     x',
    ottom: '16p     marginB             '600',
eight:       fontW      
      : '16px',    fontSize      
        <h3 style={{             }>
     }      b'
      solid #e5e7eder: '1px   bor            ',
  ,0,0.08)a(0,0 rgbpx 3 '0 1px boxShadow:            x',
   : '20p  padding            '12px',
  rRadius:       borde       ,
    '#ffffff'und:backgro       
         le={{sty <div             Table */}
 ummary ask S T    {/*          /div>

 <      v>
           </di               })()}
          
       );                vg>
   </s                   >
     </g                   ext>
  ompleted</t7280">C" fill="#6b11ze="fontSi="4"  x="105" y  <text                     
   th="2" />strokeWid" "#10b981" stroke=="0" y2" x2="100"080" y1=line x1="          <             </text>
   ">Total280b7"#6fill=ze="11" " fontSi"25" y="4<text x=                         
 "2" />h=dtrokeWist" f6="#3b82roke st" y2="0""20x2=" 1="0e x1="0" y      <lin                `}>
    - 10})eight hartH${cing}, ${padd`translate(rm={ransfo        <g t                   />
                   h="2"
  eWidttrok    s            
          "#10b981" stroke=                     "
    "none   fill=                )}
       join(' '      }).          
          ${y}`;`${x}, return                    ;
        lotHeightalue) * p maxVeted /t - (d.complighng + plotHe paddi  const y =                        i;
   h - 1)) *(daysInMontotWidth /  (pldding +const x = pa                       
      i) => {Data.map((d,dailys={    point                    
  ein      <polyl            >
                 /      2"
       okeWidth="  str                      "
  #3b82f6oke="      str                  "
   fill="none                      ')}
   ' ).join(       }                 },${y}`;
  turn `${x    re                    
    lotHeight;) * p maxValue.total / - (dplotHeight+ padding y = nst      co               ;
         * i))sInMonth - 1/ (dayotWidth ing + (plnst x = paddco                        ) => {
    p((d, iilyData.madaoints={   p                     yline
  pol       <                  })}
                           );
                     
         </g>             xt>
               </te                     )}
 1 - i / 4)alue * (nd(maxVrouh.     {Mat                         
  or="end">ch" textAnl="#9ca3af" filntSize="10 foy + 4} y={10}={padding -      <text x                     " />
    dth="1eWib" strok"#e5e7etroke= y2={y} s padding}Width - x2={charting} y1={y}add={p x1<line                           y={i}>
     <g ke                          return (
                   
       * i; 4) t /Heigh + (plotdingst y = pad con              
           p(i => {4].ma0, 1, 2, 3,   {[              
        }`}>ght + 20hartHeitWidth} ${c0 0 ${char viewBox={`20""2t= heigh100%"idth="   <svg w            n (
          retur             ;

     padding * 2hartHeight -eight = cst plotH    con            g * 2;
    addintWidth - pdth = charst plotWi   con                ng = 40;
 onst paddi         c         200;
  ght = artHeionst ch           c          600;
hartWidth =st ccon                1);
     > d.total),ata.map(d =ilyD...da = Math.max(t maxValue   cons            });

                 
        completed };th, ayTasks.lengl: d{ day, totarn  retu              
       ength;').lvedppro'atatus === ' || t.s=== 'postedtatus t.smpleted' || === 'cous stat=> t.(t tersks.fil = dayTaedt complet   cons            ;
       teStr))ith(dastartsWeadline.& t.dt.deadline &(t => lterfiTasks. = allMonthst dayTasks      con               '0')}`;
 adStart(2, tring(day).p-${StedMonth}elecr = `${sst dateSt    con             1;
     y = i + const da                    > {
  i) =_, nMonth }, ( daysI length:.from({ayyData = Arrnst dail    co            ();
    ate).getD], 0)[1plit('-'.sthdMonlecte, se)[0]plit('-'.selectedMonthDate(snth = new MoaysInnst d  co              > {
      {(() =            >
        </h3           eline
   n Tim Completio       Task            >
 {16} /e= sizUpending       <Tr       }}>
                  6px'
          gap: '              enter',
  ems: 'cignIt   al             x',
    splay: 'fle   di               937',
  f2olor: '#1     c           4px',
    ttom: '1arginBo m               0',
     '60fontWeight:            ',
        pxntSize: '15         fo
           yle={{  <h3 st       
                }}>
         eb'e5e7x solid # '1p  border:            
    ,0.08)',(0,0,0px 3px rgba'0 1dow: xSha   bo     
          ','18px   padding:           2px',
     Radius: '1  border          ,
      ffffff'ckground: '#         ba     
    {{e=v styl         <di
       */}rt ine Cha- Ltion Trend  Comple        {/*  v>

           </di          }
       })()       ;
       )              >
      </div                 </div>
                       )}
      )                       )
                             </div>
                             pan>
  </s                             0)}%)
   * 10 / total)nt((item.couth.roundount} ({Ma   {item.c                              
 }>937' }#1f2or: '', col: '600ontWeightx', fize: '13p{ fontS style={pan    <s                        /div>
             <                n>
       label}</spa{item.' }}>7280lor: '#6b, coize: '12px'le={{ fontSsty <span                              
    }></div>m.color }olor: itedCkgroun: '3px', bacerRadius', bordht: '12pxpx', heig'12h:  widt{{<div style=                               }}>
    p: '8px''center', gatems: ignI 'flex', alplay:{{ dis<div style=                             >
    }}8px'ottom: 'arginBeen', me-betwac 'spnt:nteifyCojust: 'center', nItemsflex', aligisplay: ' style={{ d{index}iv key=   <d                       
     > 0 && (  item.count                          ndex) => (
((item, imapatusData.         {st          
       %' }}>h: '100yle={{ widt st    <div             g>
            </sv                         })}
            );
                                      />
                          2"
  rokeWidth="      st                      "
    white="oke     str                    
       tem.color}    fill={i                            ={path}
     d                       
    x}   key={inde                                  <path
                       (
   return                           
                             ;
e += anglecurrentAngl                           
                           
  2} Z`; ${yx2}${} 1 ${largeArcius} 0 ius} ${rad${rad A ${y1}Y} L ${x1} erentterX} ${c= `M ${cenconst path                             0 ? 1 : 0;
 18le >c = anglargeArst    con                   
                             
     );n(endRads * Math.si + radiunterY= censt y2 co                          endRad);
  th.cos(radius * MaerX + entonst x2 = c         c              d);
     artRah.sin(stradius * MatrY + tet y1 = cen       cons                     tartRad);
cos(s * Math.erX + radius x1 = centnst        co            
                                ;
    180)/ PI ) * (Math.le - 90 (endAngst endRad =     con                    180);
   Math.PI / 90) * (le - Ang = (startrtRadconst sta                         
                               e;
gle + angl = currentAndAnglet encons                     
       Angle;rrentrtAngle = cu const sta                     360;
       total) * item.count / ( angle =const                          ll;
  nu0) return count ===  if (item.                        > {
   m, index) =te(ia.map(atusDat      {st               00">
      200 20 0Box="0" view20"0" height=h="20vg widt      <s                }>
  : 'center' }temsgnI16px', aligap: ' 'column', xDirection:, fle: 'flex'e={{ display<div styl                     (
    return                 

 terY = 100;  const cen              100;
      centerX =    const              
  us = 70;dionst ra    c         
       gle = 0;et currentAn          l        
             
           }            
        );                    </div>
              
          /p>lable<tasks avai'500' }}>No ontWeight: x', ftSize: '13ple={{ fonty<p s                       }} />
   ity: 0.3 pac o 12px',: '0 autogin{ marstyle={8} art size={4 <PieCh                        a3af' }}>
 r: '#9c', colo: '40px 20pxaddingnter', pxtAlign: 'ce te{{yle=v st     <di              urn (
            ret              0) {
  (total ===     if            
                       t, 0);
 counm + item.=> su item) sum,a.reduce((atatusD = stonst total  c                 ];
              ' }
       8b5cf6olor: '#).length, c 'approved'== t.status =||osted'  'patus ===t => t.stks.filter(llMonthTas ad', count: 'Postel:be     { la             ' },
    9e0bf5: '#olorh, c).lengt-approval'ientpending-cl === 'atuser(t => t.stTasks.filtthMonallcount: ing', label: 'Pend     {                
  981' },or: '#10bngth, cold').lemplete=== 'cotus .sta => tfilter(tnthTasks.: allMountted', cobel: 'Comple     { la               ,
  3b82f6' }h, color: '#).lengtprogress'us === 'in- t.statter(t =>.filMonthTasksll', count: aessrogrn Pl: 'Ibe        { la            ta = [
  Da status      const         {
        {(() =>               /h3>
        <       tion
    buistritatus D  Task S                 {16} />
 e=sizart eCh      <Pi            }}>
                 6px'
   p: '  ga               ter',
   cens: 'gnItem      ali             ex',
 y: 'fl      displa            
  f2937', '#1r:    colo          
      '14px',ottom: ginB  mar              600',
    Weight: 'nt         fo       ,
    px'e: '15 fontSiz           {
        <h3 style={            }>
            }  b'
        e7elid #e51px sor: '   borde       
        ,0.08)',,0,0rgba(0x x 3p: '0 1pShadow     box             px',
: '18    padding           ',
   '12pxerRadius:    bord            ffff',
   ound: '#ff    backgr         
      style={{   <div       
       Chart */}ion - Pieistributk Status D    {/* Tas        
    }>   }        x'
   20pginBottom: '         mar
       px', '16        gap:  
      r', '1fr 2fteColumns:mpla    gridTe           : 'grid',
     display            style={{
  <div              Row */}
rts    {/* Cha      div>

       </
            </div>        
       e</div>tion Rat95 }}>Comple 0.city:pa o13px',: 'Sizee={{ font<div styl                  
v>     </di            te}%
 onRapleti        {com           >
  }}om: '6px' marginBottht: '700',fontWeig '32px', ize:={{ fontSv style   <di           
    }> }        
       1,0.25)',158,1a(245x 8px rgbadow: '0 2p      boxSh            : 'white',
      color           x',
 8ppadding: '1         ,
         : '10px'borderRadius       
           ,7706 100%)', #d9 #f59e0b 0%nt(135deg,gradie'linear-ackground:   b               {{
 tyle=     <div s
                </div>           iv>
/dogress<5 }}>In Prity: 0.9'13px', opactSize: onstyle={{ f       <div          
    </div>          gth}
      ens').lin-progresus === '=> t.statfilter(t asks.lMonthT      {al           
   '6px' }}>ginBottom: : '700', marWeight2px', font '3fontSize:{{ style=  <div      
           }>    }           '
 30,246,0.25)x rgba(59,1 8p'0 2pxw:    boxShado              hite',
 : 'w color                 '18px',
 dding:  pa                x',
'10pdius: Ra      border   
         b 100%)',63e, #256 0%deg, #3b82fent(135near-gradiround: 'likg      bac         e={{
     <div styl        >
           </div        v>
   ed</dimpletCo 0.95 }}>city:'13px', opaontSize: v style={{ f       <di          
     </div>             s}
 pletedTask      {com         }}>
     m: '6px'  marginBotto: '700',htx', fontWeig'32pontSize: le={{ f<div sty                 }}>
                29,0.25)'
 (16,185,1px rgbaw: '0 2px 8 boxShado           e',
      : 'whit  color               ,
 px'adding: '18      p          '10px',
  rderRadius:     bo             
 9 100%)',1 0%, #05966g, #10b98adient(135denear-gr 'liground:ck    ba         e={{
     ylv st    <di        
    v></di      
          ks</div>>Total Tas.95 }} 0 opacity:13px',e: '{ fontSizv style={di  <                    </div>
             
 h}ks.lengtlMonthTas   {al                 px' }}>
: '6nBottom margiht: '700',tWeig2px', fone: '3e={{ fontSizyl st    <div      
           }}>             34,0.25)'
26,2,1rgba(102 2px 8px ow: '0oxShad     b       e',
      : 'whit   color           
    g: '18px', paddin                 x',
adius: '10p     borderR          00%)',
   %, #764ba2 1 07eea5deg, #66(13gradient: 'linear-background                ={{
   <div style            }}>
              
   px'om: '20Bott    margin            px',
gap: '16           ,
     1fr)'eat(4, ns: 'replumemplateCo   gridT          'grid',
    display:               tyle={{
       <div s        Cards */}
  {/* Stats       v>

      di</              </div>
            </p>
                 ytics
     analk ics and tasce metrrforman  Your pe             }}>
      13px' fontSize: '7280',color: '#6bx',  0 36pn: '6px 0le={{ margistyp        <
           /h2>      <        }
    s'yee Reportt && 'EmploepartmenrentDur    {!c               s'}
  ReportEmployee& 'Graphics aphics' &grt === 'rtmencurrentDepa      {          rts'}
     Repoloyee Emp 'Video 'video' &&===t tDepartmen   {curren                />
 size={26} t3 arChar      <B           }}>
               n: 0
             margi             p: '10px',
         ga      ,
     r'enteignItems: 'c  al               x',
   ay: 'fledispl                    937',
'#1f2r:    colo          0',
       : '70ontWeight      f              : '24px',
    fontSize               le={{
 h2 sty    <             div>
       <        }>
    }  
           'center'ems:   alignIt           ',
  -betweent: 'spaceustifyConten    j            'flex',
  display:              ,
 #e5e7eb'olid der: '1px s    bor            
0.08)',(0,0,0,x 3px rgba '0 1pdow:      boxSha    x',
      ottom: '20p     marginB
           x','20px 28padding:   p            
  '12px',Radius:  border          ff',
     nd: '#ffffou backgr      
         e={{iv styl   <d           /}
ts Header *or* Rep         {/>
     : '100vh' }}eight00%', minHidth: '1{ wtyle={v s <di       turn (
           re   th) * 100ks.lengthTas / allMontedTasks(compleund(ro> 0 ? Math.ength onthTasks.l= allMionRate nst complet    co      roved').lengs === 'app t.statud' ||osteus === 'pstat t. ||pleted's === 'comtatur(t => t.sks.filte

export default EmployeeDashboard;
